[PROVE][2020-05-01 14:19:36] .\experiment\_logs\PROVE.txt log changed to .\experiment\_logs\20200501_141936_PROVE_001_log.txt...
[PROVE][2020-05-01 14:19:36] Library [PROVE ] initialized on machine [DAMIAN_M15]
[PROVE][2020-05-01 14:19:36]   Script running in ipython.
[PROVE][2020-05-01 14:19:36] Metatada information:
[PROVE][2020-05-01 14:19:36] Loading '.\experiment\_data\df_items_top_13.5k.csv'...
[PROVE][2020-05-01 14:19:36]   Total no of products: 13000
[PROVE][2020-05-01 14:19:36]   Total no of level 1 hierarchies: 24
[PROVE][2020-05-01 14:19:36]   Total no of level 2 hierarchies: 181
[PROVE][2020-05-01 14:19:36]   Most sold individual product over period:
[PROVE][2020-05-01 14:19:36]    Name:  YUVAL NOAH HARARI / SAPIENS. SCURTA ISTORIE A OMENIRII
[PROVE][2020-05-01 14:19:36]    Id:    545535
[PROVE][2020-05-01 14:19:36]    Freq:  21248
[PROVE][2020-05-01 14:19:36]    Hrchy: 1/17
[PROVE][2020-05-01 14:19:36]   Least sold individual product over period:
[PROVE][2020-05-01 14:19:36]    Name:  DAVID GROSSMAN / UN CAL INTRA ÃŽNTR-UN BAR
[PROVE][2020-05-01 14:19:36]    Id:    442552
[PROVE][2020-05-01 14:19:36]    Freq:  156
[PROVE][2020-05-01 14:19:36]    Hrchy: 1/0
[PROVE][2020-05-01 14:19:36] Loading json 'obfuscated_keys.txt' from 'data'
[PROVE][2020-05-01 14:19:37] *Hierarchy level 1 'Ierarhie1' contains 32 categories*
[PROVE][2020-05-01 14:19:37]   Category name: ACCESORII GASTRO AA  Id:   9  Prods:  523
[PROVE][2020-05-01 14:19:37]   Category name: ALTELE               Id:  26  Prods:    9
[PROVE][2020-05-01 14:19:37]   Category name: CARTE ROM            Id:   1  Prods: 7202
[PROVE][2020-05-01 14:19:37]   Category name: CARTE STRAINA        Id:   0  Prods:  736
[PROVE][2020-05-01 14:19:37]   ...
[PROVE][2020-05-01 14:19:37] *Hierarchy level 2 'Ierarhie2' contains 356 categories*
[PROVE][2020-05-01 14:19:37]   Category name: ACCESORII              Id: 116  Prods:    3
[PROVE][2020-05-01 14:19:37]   Category name: ACCESORII FASHION      Id: 274  Prods:   21
[PROVE][2020-05-01 14:19:37]   Category name: ACCESORII MASA         Id: 249  Prods:   26
[PROVE][2020-05-01 14:19:37]   Category name: ALTELE                 Id:  60  Prods:   60
[PROVE][2020-05-01 14:19:37]   ...
[PROVE][2020-05-01 14:19:37] Top neighbors for 9440: 'beatles':
[PROVE][2020-05-01 14:19:37]   beatles:    0.000
[PROVE][2020-05-01 14:19:37]   lennon:     0.246
[PROVE][2020-05-01 14:19:37]   mccartney:  0.276
[PROVE][2020-05-01 14:19:37]   dylan:      0.304
[PROVE][2020-05-01 14:19:38]   songs:      0.305
[PROVE][2020-05-01 14:19:38]   recordings: 0.325
[PROVE][2020-05-01 14:19:38]   albums:     0.326
[PROVE][2020-05-01 14:19:38]   elvis:      0.326
[PROVE][2020-05-01 14:19:38]   motown:     0.327
[PROVE][2020-05-01 14:19:38]   presley:    0.333
[PROVE][2020-05-01 14:19:38] *Hierarchy level 1 'Ierarhie1' contains 8 categories*
[PROVE][2020-05-01 14:19:38]   Category name: COMICS&MANGA  Id:  21  Prods:  135
[PROVE][2020-05-01 14:19:38]   Category name: GASTRONOMIE   Id:  20  Prods:  196
[PROVE][2020-05-01 14:19:38]   Category name: HOME&DECO AA  Id:  10  Prods:  174
[PROVE][2020-05-01 14:19:38]   Category name: LIFESTYLE     Id:  12  Prods:  239
[PROVE][2020-05-01 14:19:38]   Category name: MULTIMEDIA    Id:   8  Prods:  411
[PROVE][2020-05-01 14:19:38]   Category name: MUZICA        Id:   2  Prods:  219
[PROVE][2020-05-01 14:19:38]   Category name: NOVELTY       Id:  23  Prods:  103
[PROVE][2020-05-01 14:19:38]   Category name: VINURI        Id:  14  Prods:   23
[PROVE][2020-05-01 14:19:38] *Hierarchy level 2 'Ierarhie2' contains 14 categories*
[PROVE][2020-05-01 14:19:38]   Category name: Audiobook CD           Id: 111  Prods:    7
[PROVE][2020-05-01 14:19:38]   Category name: BLU-RAY                Id:  36  Prods:   16
[PROVE][2020-05-01 14:19:38]   Category name: BOARD GAMES            Id: 140  Prods:  165
[PROVE][2020-05-01 14:19:38]   Category name: Backtoschool           Id: 108  Prods:   16
[PROVE][2020-05-01 14:19:38]   Category name: Bakery                 Id: 269  Prods:   10
[PROVE][2020-05-01 14:19:38]   Category name: COMICS                 Id:  87  Prods:    3
[PROVE][2020-05-01 14:19:38]   Category name: Comics                 Id: 120  Prods:   23
[PROVE][2020-05-01 14:19:38]   Category name: FILOSOFIE              Id:  43  Prods:  144
[PROVE][2020-05-01 14:19:38]   Category name: Giftware               Id: 107  Prods:   95
[PROVE][2020-05-01 14:19:38]   Category name: LIFESTYLE              Id: 283  Prods:   11
[PROVE][2020-05-01 14:19:38]   Category name: MANGA                  Id:  63  Prods:   87
[PROVE][2020-05-01 14:19:38]   Category name: Travel Mug             Id: 144  Prods:   66
[PROVE][2020-05-01 14:19:38]   Category name: Travelling collection  Id:  75  Prods:   19
[PROVE][2020-05-01 14:19:38]   Category name: Vinyl                  Id:  10  Prods:   52
[PROVE][2020-05-01 14:19:38] Loading numpy data 'exp_v4es_033.npy' from 'models'
[PROVE][2020-05-01 14:19:38] EmbedsEngine v.0.1.0.1 startup.
[PROVE][2020-05-01 14:19:38] Initializing Embeddings processing Engine v0.1.0.1.
[PROVE][2020-05-01 14:19:38] Preparing product dicts
[PROVE][2020-05-01 14:19:38] Found category string in 'Ierarhie1_name'
[PROVE][2020-05-01 14:19:38] Found category string in 'Ierarhie2_name'
[PROVE][2020-05-01 14:19:38] Loading pickle 'emb_eng.pkl' from 'models'
[PROVE][2020-05-01 14:19:39]   Pickle loaded.
[PROVE][2020-05-01 14:19:39]  
[PROVE][2020-05-01 14:19:39] Product '12071' info:
[PROVE][2020-05-01 14:19:39]   NAME: CD / DAVID BOWIE / BLACKSTAR (
[PROVE][2020-05-01 14:19:39]   Ierarhie1: 2
[PROVE][2020-05-01 14:19:39]   Ierarhie1_name: MUZICA
[PROVE][2020-05-01 14:19:39]   Ierarhie2: 4
[PROVE][2020-05-01 14:19:39]   Ierarhie2_name: CD International
[PROVE][2020-05-01 14:19:39]   POS_EDGES (102 items):
[PROVE][2020-05-01 14:19:39]              IDE                        ItemName Ierarhie1_name    Ierarhie2_name  Ierarhie1  Ierarhie2
    1032    1032  CD / QUEEN / BOHEMIAN RHAPSODY         MUZICA  CD International          2          4
    10780  10780  CD / TWENTY ONE PILOTS / TRENC         MUZICA  CD International          2          4
    11834  11834   CD / NIRVANA / NIRVANA (2002)         MUZICA  CD International          2          4
    11326  11326  CD / SELENA GOMEZ / REVIVAL (D         MUZICA  CD International          2          4
    12862  12862  CD / DREAM THEATER / THE TRIPL         MUZICA  CD International          2          4
[PROVE][2020-05-01 14:19:39]   NEG_EDGES (6 items):
[PROVE][2020-05-01 14:19:39]              IDE                        ItemName       Ierarhie1_name                     Ierarhie2_name  Ierarhie1  Ierarhie2
    8392    8392                13.2X2.5CM PLATE  ACCESORII GASTRO AA              Accesorii servit masa          9         16
    12266  12266  TIM DEDOPULOS / HERCULE POIROT            CARTE ROM               PRACTIC / TIMP LIBER          1         30
    4400    4400  CARTEA SARUTURILOR / IV CEL NA            CARTE ROM  POEZIE / TEATRU / STUDII LITERARE          1          2
    9745    9745  MASINI DIE-CAST 7.5cm III ASST              JUCARII                            JUCARII          4         73
    10135  10135  BUCATARIE ITALIANA 100 DE RETE            CARTE ROM                        GASTRONOMIE          1         78
[PROVE][2020-05-01 14:19:39]  
[PROVE][2020-05-01 14:19:39]   Table: Non-filtered neighbors of 12071 using exp_v4es_033.npy model
[PROVE][2020-05-01 14:19:39]         ID  DIST                            NAME               H1                    H2
  0  12071  0.00  CD / DAVID BOWIE / BLACKSTAR (           MUZICA      CD International
  1  11418  0.64  CD / DAVID BOWIE / BEST OF BOW           MUZICA      CD International
  2   4416  0.64  CD / COLDPLAY / 4 CD CATALOGUE           MUZICA      CD International
  3   4865  0.66  CD / COLDPLAY / A HEAD FULL OF           MUZICA      CD International
  4   9745  0.67  MASINI DIE-CAST 7.5cm III ASST          JUCARII               JUCARII
  5   7933  0.67     CUVINTE INCRUCISATE/ IQ FUN        CARTE ROM    CARTI PENTRU COPII
  6   8392  0.68                13.2X2.5CM PLATE  ACCESORII GASTR  Accesorii servit mas
  7  10135  0.68  BUCATARIE ITALIANA 100 DE RETE        CARTE ROM           GASTRONOMIE
  8   4400  0.68  CARTEA SARUTURILOR / IV CEL NA        CARTE ROM  POEZIE / TEATRU / ST
  9  12266  0.70  TIM DEDOPULOS / HERCULE POIROT        CARTE ROM  PRACTIC / TIMP LIBER
[PROVE][2020-05-01 14:19:39] ================================================================================================
[PROVE][2020-05-01 14:19:39] ================================================================================================
[PROVE][2020-05-01 14:19:39] == Iteration 1: ================================================================================
[PROVE][2020-05-01 14:19:39] ================================================================================================
[PROVE][2020-05-01 14:19:39] {'method': 'v4_th', 'batch_size': 256, 'dist': 'l1'}
[PROVE][2020-05-01 14:19:39] ================================================================================================
[PROVE][2020-05-01 14:19:39]  
[PROVE][2020-05-01 14:19:39] Performing retrofitting on (13000, 128) embedding matrix...
[PROVE][2020-05-01 14:19:39]   Product(s):  None
[PROVE][2020-05-01 14:19:39]   Full edges:  True
[PROVE][2020-05-01 14:19:39]   Method:      _get_retrofitted_embeds_v4_th
[PROVE][2020-05-01 14:19:39]   Pos edges: 13000
[PROVE][2020-05-01 14:19:39]   Neg edges: 13000
[PROVE][2020-05-01 14:19:39] Starting `_get_retrofitted_embeds_v4_th()` retrofit function
[PROVE][2020-05-01 14:19:40]   Preparing retrofit data based on dict(13000)...
[PROVE][2020-05-01 14:19:40]     Positive edges: 13000
[PROVE][2020-05-01 14:19:40]     Negative edges: 13000
[PROVE][2020-05-01 14:19:41]   Preparing torch model...
[PROVE][2020-05-01 14:19:43]   Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, negative margin: 128, dist=l1, fixed_weights=None
