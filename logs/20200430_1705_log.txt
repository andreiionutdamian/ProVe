Metatada information:
  Total no of products: 13000
  Total no of level 1 hierarchies: 24
  Total no of level 2 hierarchies: 181
  Most sold individual product over period:
   Name:  YUVAL NOAH HARARI / SAPIENS. SCURTA ISTORIE A OMENIRII
   Id:    545535
   Freq:  21248
   Hrchy: 1/17
  Least sold individual product over period:
   Name:  DAVID GROSSMAN / UN CAL INTRA ÎNTR-UN BAR
   Id:    442552
   Freq:  156
   Hrchy: 1/0
*Hierarchy level 1 'Ierarhie1' contains 32 categories*
  Category name: ACCESORII GASTRO AA  Id:   9  Prods:  523
  Category name: ALTELE               Id:  26  Prods:    9
  Category name: CARTE ROM            Id:   1  Prods: 7202
  Category name: CARTE STRAINA        Id:   0  Prods:  736
  ...
*Hierarchy level 2 'Ierarhie2' contains 356 categories*
  Category name: ACCESORII              Id: 116  Prods:    3
  Category name: ACCESORII FASHION      Id: 274  Prods:   21
  Category name: ACCESORII MASA         Id: 249  Prods:   26
  Category name: ALTELE                 Id:  60  Prods:   60
  ...
Top neighbors for 9440: 'beatles':
  beatles:    0.000
  lennon:     0.246
  mccartney:  0.276
  dylan:      0.304
  songs:      0.305
  recordings: 0.325
  albums:     0.326
  elvis:      0.326
  motown:     0.327
  presley:    0.333
*Hierarchy level 1 'Ierarhie1' contains 8 categories*
  Category name: COMICS&MANGA  Id:  21  Prods:  135
  Category name: GASTRONOMIE   Id:  20  Prods:  196
  Category name: HOME&DECO AA  Id:  10  Prods:  174
  Category name: LIFESTYLE     Id:  12  Prods:  239
  Category name: MULTIMEDIA    Id:   8  Prods:  411
  Category name: MUZICA        Id:   2  Prods:  219
  Category name: NOVELTY       Id:  23  Prods:  103
  Category name: VINURI        Id:  14  Prods:   23
*Hierarchy level 2 'Ierarhie2' contains 14 categories*
  Category name: Audiobook CD           Id: 111  Prods:    7
  Category name: BLU-RAY                Id:  36  Prods:   16
  Category name: BOARD GAMES            Id: 140  Prods:  165
  Category name: Backtoschool           Id: 108  Prods:   16
  Category name: Bakery                 Id: 269  Prods:   10
  Category name: COMICS                 Id:  87  Prods:    3
  Category name: Comics                 Id: 120  Prods:   23
  Category name: FILOSOFIE              Id:  43  Prods:  144
  Category name: Giftware               Id: 107  Prods:   95
  Category name: LIFESTYLE              Id: 283  Prods:   11
  Category name: MANGA                  Id:  63  Prods:   87
  Category name: Travel Mug             Id: 144  Prods:   66
  Category name: Travelling collection  Id:  75  Prods:   19
  Category name: Vinyl                  Id:  10  Prods:   52
Initializing Embeddings processing Engine v0.1.0.1.
Preparing product dicts
Found category string in 'Ierarhie1_name'
Found category string in 'Ierarhie2_name'
Item knowledge graph loaded.		

Product '12071' info:
  NAME: CD / DAVID BOWIE / BLACKSTAR (
  Ierarhie1: 2
  Ierarhie1_name: MUZICA
  Ierarhie2: 4
  Ierarhie2_name: CD International
  POS_EDGES (102 items):
             IDE                        ItemName Ierarhie1_name    Ierarhie2_name  Ierarhie1  Ierarhie2
    1032    1032  CD / QUEEN / BOHEMIAN RHAPSODY         MUZICA  CD International          2          4
    10780  10780  CD / TWENTY ONE PILOTS / TRENC         MUZICA  CD International          2          4
    11834  11834   CD / NIRVANA / NIRVANA (2002)         MUZICA  CD International          2          4
    11326  11326  CD / SELENA GOMEZ / REVIVAL (D         MUZICA  CD International          2          4
    12862  12862  CD / DREAM THEATER / THE TRIPL         MUZICA  CD International          2          4
  NEG_EDGES (6 items):
             IDE                        ItemName       Ierarhie1_name                     Ierarhie2_name  Ierarhie1  Ierarhie2
    8392    8392                13.2X2.5CM PLATE  ACCESORII GASTRO AA              Accesorii servit masa          9         16
    12266  12266  TIM DEDOPULOS / HERCULE POIROT            CARTE ROM               PRACTIC / TIMP LIBER          1         30
    4400    4400  CARTEA SARUTURILOR / IV CEL NA            CARTE ROM  POEZIE / TEATRU / STUDII LITERARE          1          2
    9745    9745  MASINI DIE-CAST 7.5cm III ASST              JUCARII                            JUCARII          4         73
    10135  10135  BUCATARIE ITALIANA 100 DE RETE            CARTE ROM                        GASTRONOMIE          1         78

  Table: Non-filtered neighbors of 12071 using exp_v4es_033.npy model
        ID  DIST                            NAME               H1                    H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (           MUZICA      CD International
  1  11418 0.644  CD / DAVID BOWIE / BEST OF BOW           MUZICA      CD International
  2   4416 0.645  CD / COLDPLAY / 4 CD CATALOGUE           MUZICA      CD International
  3   4865 0.663  CD / COLDPLAY / A HEAD FULL OF           MUZICA      CD International
  4   9745 0.665  MASINI DIE-CAST 7.5cm III ASST          JUCARII               JUCARII
  5   7933 0.675     CUVINTE INCRUCISATE/ IQ FUN        CARTE ROM    CARTI PENTRU COPII
  6   8392 0.676                13.2X2.5CM PLATE  ACCESORII GASTR  Accesorii servit mas
  7  10135 0.678  BUCATARIE ITALIANA 100 DE RETE        CARTE ROM           GASTRONOMIE
  8   4400 0.682  CARTEA SARUTURILOR / IV CEL NA        CARTE ROM  POEZIE / TEATRU / ST
  9  12266 0.697  TIM DEDOPULOS / HERCULE POIROT        CARTE ROM  PRACTIC / TIMP LIBER
================================================================================================
================================================================================================
== Iteration 1: ================================================================================
================================================================================================
{'method': 'v4_th', 'batch_size': 256, 'dist': 'l2'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v4_th
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v4_th()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing torch model...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, negative margin: 128, dist=l2, fixed_weights=None
    Epoch 01/99 - loss: 30678.82 (P/R/N: 33.98/8715.39/21929.45), change:16.886, time: 2.7s, batch: 200, fails: 0
    Epoch 02/99 - loss: 28146.93 (P/R/N: 249.38/7815.93/20081.62), change:12.147, time: 2.8s, batch: 200, fails: 0
    Epoch 03/99 - loss: 25875.77 (P/R/N: 688.98/7662.30/17524.48), change:14.107, time: 2.7s, batch: 200, fails: 0
    Epoch 04/99 - loss: 23630.41 (P/R/N: 1316.07/7984.00/14330.35), change:15.732, time: 2.7s, batch: 200, fails: 0
    Epoch 05/99 - loss: 21569.78 (P/R/N: 2056.25/8457.58/11055.95), change:16.940, time: 3.1s, batch: 200, fails: 0
    Epoch 06/99 - loss: 19836.18 (P/R/N: 2824.12/8812.13/8199.93), change:18.004, time: 2.7s, batch: 200, fails: 0
    Epoch 07/99 - loss: 18436.80 (P/R/N: 3543.22/8925.50/5968.08), change:18.701, time: 2.7s, batch: 200, fails: 0
    Epoch 08/99 - loss: 17340.53 (P/R/N: 4191.65/8807.23/4341.64), change:19.243, time: 2.7s, batch: 200, fails: 0
    Epoch 09/99 - loss: 16409.34 (P/R/N: 4743.36/8466.29/3199.69), change:19.323, time: 2.7s, batch: 200, fails: 0
    Epoch 10/99 - loss: 15639.24 (P/R/N: 5216.46/8001.18/2421.60), change:19.636, time: 2.7s, batch: 200, fails: 0
    Epoch 11/99 - loss: 14995.63 (P/R/N: 5639.72/7478.63/1877.29), change:19.965, time: 3.1s, batch: 200, fails: 0
    Epoch 12/99 - loss: 14413.39 (P/R/N: 6004.95/6915.38/1493.07), change:19.951, time: 2.7s, batch: 200, fails: 0
    Epoch 13/99 - loss: 13934.17 (P/R/N: 6341.86/6372.89/1219.42), change:20.279, time: 2.7s, batch: 200, fails: 0
    Epoch 14/99 - loss: 13520.18 (P/R/N: 6647.52/5851.46/1021.20), change:20.134, time: 2.7s, batch: 200, fails: 0
    Epoch 15/99 - loss: 13144.38 (P/R/N: 6913.17/5354.80/876.41), change:20.350, time: 2.7s, batch: 200, fails: 0
    Epoch 16/99 - loss: 12866.28 (P/R/N: 7169.68/4919.19/777.42), change:20.562, time: 2.7s, batch: 200, fails: 0
    Epoch 17/99 - loss: 12602.65 (P/R/N: 7388.63/4521.17/692.85), change:20.720, time: 2.7s, batch: 200, fails: 0
    Epoch 18/99 - loss: 12406.43 (P/R/N: 7598.37/4173.67/634.39), change:21.017, time: 2.7s, batch: 200, fails: 0
    Epoch 19/99 - loss: 12231.90 (P/R/N: 7769.02/3871.65/591.23), change:21.096, time: 2.7s, batch: 200, fails: 0
    Epoch 20/99 - loss: 12108.40 (P/R/N: 7948.62/3615.60/544.18), change:21.290, time: 2.7s, batch: 200, fails: 0
    Epoch 21/99 - loss: 11987.12 (P/R/N: 8076.72/3389.41/520.99), change:21.417, time: 2.7s, batch: 200, fails: 0
    Epoch 22/99 - loss: 11910.88 (P/R/N: 8208.34/3203.09/499.44), change:21.803, time: 3.1s, batch: 200, fails: 0
    Epoch 23/99 - loss: 11848.34 (P/R/N: 8320.51/3044.86/482.97), change:22.077, time: 2.7s, batch: 200, fails: 0
    Epoch 24/99 - loss: 11777.63 (P/R/N: 8411.37/2908.32/457.94), change:22.265, time: 2.9s, batch: 200, fails: 0
    Epoch 25/99 - loss: 11743.90 (P/R/N: 8495.35/2793.42/455.13), change:22.481, time: 2.7s, batch: 200, fails: 0
    Epoch 26/99 - loss: 11707.34 (P/R/N: 8570.27/2696.39/440.68), change:22.880, time: 2.7s, batch: 200, fails: 0
    Epoch 27/99 - loss: 11675.98 (P/R/N: 8627.57/2613.24/435.16), change:22.888, time: 2.7s, batch: 200, fails: 0
    Epoch 28/99 - loss: 11660.02 (P/R/N: 8685.60/2545.67/428.75), change:23.202, time: 3.1s, batch: 200, fails: 0
    Epoch 29/99 - loss: 11633.64 (P/R/N: 8728.20/2486.12/419.32), change:23.615, time: 2.7s, batch: 200, fails: 0
    Epoch 30/99 - loss: 11624.44 (P/R/N: 8774.16/2437.53/412.74), change:23.623, time: 2.7s, batch: 200, fails: 0
    Epoch 31/99 - loss: 11605.59 (P/R/N: 8806.72/2389.79/409.08), change:24.069, time: 2.7s, batch: 200, fails: 0
    Epoch 32/99 - loss: 11594.14 (P/R/N: 8833.42/2354.42/406.31), change:23.853, time: 2.7s, batch: 200, fails: 0
    Epoch 33/99 - loss: 11565.83 (P/R/N: 8846.98/2318.81/400.04), change:24.115, time: 2.7s, batch: 200, fails: 0
    Epoch 34/99 - loss: 11577.19 (P/R/N: 8882.19/2295.55/399.45), change:24.378, time: 2.7s, batch: 200, fails: 1
    Epoch 35/99 - loss: 11558.85 (P/R/N: 8896.66/2269.80/392.40), change:24.626, time: 2.7s, batch: 200, fails: 0
    Epoch 36/99 - loss: 11568.58 (P/R/N: 8915.60/2250.10/402.89), change:24.896, time: 2.7s, batch: 200, fails: 1
    Epoch 37/99 - loss: 11551.11 (P/R/N: 8928.75/2232.26/390.10), change:24.894, time: 2.7s, batch: 200, fails: 0
    Epoch 38/99 - loss: 11542.76 (P/R/N: 8938.30/2215.19/389.27), change:24.720, time: 2.7s, batch: 200, fails: 0
    Epoch 39/99 - loss: 11537.79 (P/R/N: 8952.40/2202.38/383.01), change:24.976, time: 2.7s, batch: 200, fails: 0
    Epoch 40/99 - loss: 11528.25 (P/R/N: 8950.40/2187.24/390.61), change:25.323, time: 3.1s, batch: 200, fails: 0
    Epoch 41/99 - loss: 11522.09 (P/R/N: 8959.23/2176.00/386.86), change:25.175, time: 2.7s, batch: 200, fails: 0
    Epoch 42/99 - loss: 11521.77 (P/R/N: 8969.56/2167.18/385.03), change:25.390, time: 2.7s, batch: 200, fails: 0
    Epoch 43/99 - loss: 11527.03 (P/R/N: 8981.15/2163.42/382.46), change:25.447, time: 2.7s, batch: 200, fails: 1
    Epoch 44/99 - loss: 11514.24 (P/R/N: 8984.91/2152.59/376.75), change:25.602, time: 2.7s, batch: 200, fails: 0
    Epoch 45/99 - loss: 11510.32 (P/R/N: 8990.24/2147.70/372.38), change:25.513, time: 2.8s, batch: 200, fails: 0
    Epoch 46/99 - loss: 11508.09 (P/R/N: 8986.04/2139.90/382.15), change:25.723, time: 3.2s, batch: 200, fails: 0
    Epoch 47/99 - loss: 11508.63 (P/R/N: 9002.69/2137.33/368.60), change:25.656, time: 2.7s, batch: 200, fails: 1
    Epoch 48/99 - loss: 11498.42 (P/R/N: 8997.81/2127.21/373.39), change:25.750, time: 2.7s, batch: 200, fails: 0
    Epoch 49/99 - loss: 11500.48 (P/R/N: 9000.81/2128.14/371.52), change:26.243, time: 2.7s, batch: 200, fails: 1
    Epoch 50/99 - loss: 11500.48 (P/R/N: 9000.75/2121.31/378.43), change:26.182, time: 2.7s, batch: 200, fails: 2
    Stopping traing at epoch 50
Retrofit with '_get_retrofitted_embeds_v4_th' took 140.8s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.041
  Distance from negative 9745:   0.782

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1   4416 0.021  CD / COLDPLAY / 4 CD CATALOGUE  MUZICA  CD International
  2  12238 0.022  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  3   7004 0.023  CD / PINK MARTINI / JE DIS OUI  MUZICA  CD International
  4  12225 0.023  CD / FRANK SINATRA / NOTHING B  MUZICA  CD International
  5  11625 0.024  CD / V/A / ULTIMATE ROCK (2015  MUZICA  CD International
  6   1408 0.024  CD / QUEEN / THE PLATINUM COLL  MUZICA  CD International
  7   6275 0.025  CD / LANA DEL REY / LUST FOR L  MUZICA  CD International
  8  11718 0.025  CD / SIA / THIS IS ACTING (Del  MUZICA  CD International
  9   4865 0.026  CD / COLDPLAY / A HEAD FULL OF  MUZICA  CD International
