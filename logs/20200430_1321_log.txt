Metatada information:
  Total no of products: 13000
  Total no of level 1 hierarchies: 24
  Total no of level 2 hierarchies: 181
  Most sold individual product over period:
   Name:  YUVAL NOAH HARARI / SAPIENS. SCURTA ISTORIE A OMENIRII
   Id:    545535
   Freq:  21248
   Hrchy: 1/17
  Least sold individual product over period:
   Name:  DAVID GROSSMAN / UN CAL INTRA ÎNTR-UN BAR
   Id:    442552
   Freq:  156
   Hrchy: 1/0
Loading MCO...
Loading raw data...
  MCO Processing done in 0.08 min (sparse mat creation: 0.08 min):
  Start date: None
  End date:   None
  Max co-occ: 5998.0

**Co-occurence distribution:**
    Counts: 00 6382178 913964 293414 138452 77970 49730 34124 24904 18758
    Values:  0       1      2      3      4     5     6     7     8     9

**Transactions size distribution:**
    Counts: 00 00 1210270 484388 194496 86254 41847 21134 11616 6430
    Values:  0  1       2      3      4     5     6     7     8    9

**Transactional data structure:**
    RangeIndex: 5767223 entries, 0 to 5767222
    Data columns (total 8 columns):
     #   Column     Dtype  
    ---  ------     -----  
     0   BasketId   int64  
     1   ItemId     int64  
     2   SiteId     int64  
     3   TimeStamp  object 
     4   Qtty       float64
     5   ClientId   int64  
     6   IsActive   int64  
     7   IDE        int64  
    dtypes: float64(1), int64(6), object(1)
    memory usage: 352.0+ MB


MCO data: (only 7x7 values displayed)
    [[   0.   25.   49. 5998.  297.   85.   28.]
     [  25.    0.   32.   19.    6.    9.   15.]
     [  49.   32.    0.   22.    8.   15.   28.]
     [5998.   19.   22.    0.  165.   42.   13.]
     [ 297.    6.    8.  165.    0.  141.   11.]
     [  85.    9.   15.   42.  141.    0.   11.]
     [  28.   15.   28.   13.   11.   11.    0.]]
Saving 'exp_models\exp_mco.npz'
*Hierarchy level 1 'Ierarhie1' contains 32 categories*
  Category name: ACCESORII GASTRO AA  Id:   9  Prods:  523
  Category name: ALTELE               Id:  26  Prods:    9
  Category name: CARTE ROM            Id:   1  Prods: 7202
  Category name: CARTE STRAINA        Id:   0  Prods:  736
  ...
*Hierarchy level 2 'Ierarhie2' contains 356 categories*
  Category name: ACCESORII              Id: 116  Prods:    3
  Category name: ACCESORII FASHION      Id: 274  Prods:   21
  Category name: ACCESORII MASA         Id: 249  Prods:   26
  Category name: ALTELE                 Id:  60  Prods:   60
  ...
Loading GloVe word embeddings
Top neighbors for 9440: 'beatles':
  beatles:    0.000
  lennon:     0.246
  mccartney:  0.276
  dylan:      0.304
  songs:      0.305
  recordings: 0.325
  albums:     0.326
  elvis:      0.326
  motown:     0.327
  presley:    0.333
*Hierarchy level 1 'Ierarhie1' contains 8 categories*
  Category name: COMICS&MANGA  Id:  21  Prods:  135
  Category name: GASTRONOMIE   Id:  20  Prods:  196
  Category name: HOME&DECO AA  Id:  10  Prods:  174
  Category name: LIFESTYLE     Id:  12  Prods:  239
  Category name: MULTIMEDIA    Id:   8  Prods:  411
  Category name: MUZICA        Id:   2  Prods:  219
  Category name: NOVELTY       Id:  23  Prods:  103
  Category name: VINURI        Id:  14  Prods:   23
*Hierarchy level 2 'Ierarhie2' contains 14 categories*
  Category name: Audiobook CD           Id: 111  Prods:    7
  Category name: BLU-RAY                Id:  36  Prods:   16
  Category name: BOARD GAMES            Id: 140  Prods:  165
  Category name: Backtoschool           Id: 108  Prods:   16
  Category name: Bakery                 Id: 269  Prods:   10
  Category name: COMICS                 Id:  87  Prods:    3
  Category name: Comics                 Id: 120  Prods:   23
  Category name: FILOSOFIE              Id:  43  Prods:  144
  Category name: Giftware               Id: 107  Prods:   95
  Category name: LIFESTYLE              Id: 283  Prods:   11
  Category name: MANGA                  Id:  63  Prods:   87
  Category name: Travel Mug             Id: 144  Prods:   66
  Category name: Travelling collection  Id:  75  Prods:   19
  Category name: Vinyl                  Id:  10  Prods:   52
Initializing Embeddings processing Engine v0.1.0.1.
Preparing product dicts
Found category string in 'Ierarhie1_name'
Found category string in 'Ierarhie2_name'
Item knowledge graph loaded.		

Product '12071' info:
  NAME: CD / DAVID BOWIE / BLACKSTAR (
  Ierarhie1: 2
  Ierarhie1_name: MUZICA
  Ierarhie2: 4
  Ierarhie2_name: CD International
  POS_EDGES (102 items):
             IDE                        ItemName Ierarhie1_name    Ierarhie2_name  Ierarhie1  Ierarhie2
    1032    1032  CD / QUEEN / BOHEMIAN RHAPSODY         MUZICA  CD International          2          4
    10780  10780  CD / TWENTY ONE PILOTS / TRENC         MUZICA  CD International          2          4
    11834  11834   CD / NIRVANA / NIRVANA (2002)         MUZICA  CD International          2          4
    11326  11326  CD / SELENA GOMEZ / REVIVAL (D         MUZICA  CD International          2          4
    12862  12862  CD / DREAM THEATER / THE TRIPL         MUZICA  CD International          2          4
  NEG_EDGES (6 items):
             IDE                        ItemName       Ierarhie1_name                     Ierarhie2_name  Ierarhie1  Ierarhie2
    8392    8392                13.2X2.5CM PLATE  ACCESORII GASTRO AA              Accesorii servit masa          9         16
    12266  12266  TIM DEDOPULOS / HERCULE POIROT            CARTE ROM               PRACTIC / TIMP LIBER          1         30
    4400    4400  CARTEA SARUTURILOR / IV CEL NA            CARTE ROM  POEZIE / TEATRU / STUDII LITERARE          1          2
    9745    9745  MASINI DIE-CAST 7.5cm III ASST              JUCARII                            JUCARII          4         73
    10135  10135  BUCATARIE ITALIANA 100 DE RETE            CARTE ROM                        GASTRONOMIE          1         78

  Table: Non-filtered neighbors of 12071 using exp_v4es_033.npy model
        ID  DIST                            NAME               H1                    H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (           MUZICA      CD International
  1  11418 0.644  CD / DAVID BOWIE / BEST OF BOW           MUZICA      CD International
  2   4416 0.645  CD / COLDPLAY / 4 CD CATALOGUE           MUZICA      CD International
  3   4865 0.663  CD / COLDPLAY / A HEAD FULL OF           MUZICA      CD International
  4   9745 0.665  MASINI DIE-CAST 7.5cm III ASST          JUCARII               JUCARII
  5   7933 0.675     CUVINTE INCRUCISATE/ IQ FUN        CARTE ROM    CARTI PENTRU COPII
  6   8392 0.676                13.2X2.5CM PLATE  ACCESORII GASTR  Accesorii servit mas
  7  10135 0.678  BUCATARIE ITALIANA 100 DE RETE        CARTE ROM           GASTRONOMIE
  8   4400 0.682  CARTEA SARUTURILOR / IV CEL NA        CARTE ROM  POEZIE / TEATRU / ST
  9  12266 0.697  TIM DEDOPULOS / HERCULE POIROT        CARTE ROM  PRACTIC / TIMP LIBER
================================================================================================
================================================================================================
== Iteration 1: ================================================================================
================================================================================================
{'method': 'v4_th', 'batch_size': 1024, 'dist': 'l1'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v4_th
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v4_th()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing torch model...
  Training model for 99 epochs, batch=1024, lr=5.0e-02, tol=1.0e-03, negative margin: 128, dist=l1, fixed_weights=None
    Epoch 01/99 - loss: 123763.87 (P/R/N: 2052.70/52909.37/68801.79), change:14.922, time: 2.6s, batch: 712, fails: 0
    Epoch 02/99 - loss: 122459.21 (P/R/N: 6386.49/52806.92/63265.79), change:9.713, time: 2.5s, batch: 712, fails: 0
    Epoch 03/99 - loss: 119988.26 (P/R/N: 8500.60/51162.64/60325.02), change:6.943, time: 2.3s, batch: 712, fails: 0
    Epoch 04/99 - loss: 117832.08 (P/R/N: 10014.00/50881.75/56936.34), change:6.468, time: 2.6s, batch: 712, fails: 0
    Epoch 05/99 - loss: 116043.71 (P/R/N: 11575.66/50651.73/53816.33), change:6.373, time: 2.5s, batch: 712, fails: 0
    Epoch 06/99 - loss: 114375.92 (P/R/N: 13024.49/50540.18/50811.27), change:6.119, time: 2.5s, batch: 712, fails: 0
    Epoch 07/99 - loss: 113004.96 (P/R/N: 14497.61/50559.38/47947.98), change:6.027, time: 2.4s, batch: 712, fails: 0
    Epoch 08/99 - loss: 111689.32 (P/R/N: 15780.92/50574.23/45334.17), change:5.752, time: 2.4s, batch: 712, fails: 0
    Epoch 09/99 - loss: 110584.36 (P/R/N: 17047.99/50603.57/42932.80), change:5.717, time: 2.3s, batch: 712, fails: 0
    Epoch 10/99 - loss: 109591.27 (P/R/N: 18183.31/50619.10/40788.86), change:5.537, time: 2.4s, batch: 712, fails: 0
    Epoch 11/99 - loss: 108677.14 (P/R/N: 19302.61/50657.22/38717.32), change:5.519, time: 2.4s, batch: 712, fails: 0
    Epoch 12/99 - loss: 107842.91 (P/R/N: 20304.32/50632.15/36906.44), change:5.450, time: 2.4s, batch: 712, fails: 0
    Epoch 13/99 - loss: 107065.95 (P/R/N: 21262.06/50622.70/35181.20), change:5.414, time: 2.3s, batch: 712, fails: 0
    Epoch 14/99 - loss: 106394.84 (P/R/N: 22198.91/50574.60/33621.32), change:5.361, time: 2.5s, batch: 712, fails: 0
    Epoch 15/99 - loss: 105727.16 (P/R/N: 23063.47/50543.82/32119.87), change:5.327, time: 2.5s, batch: 712, fails: 0
    Epoch 16/99 - loss: 105144.84 (P/R/N: 23861.77/50454.00/30829.08), change:5.316, time: 2.4s, batch: 712, fails: 0
    Epoch 17/99 - loss: 104587.09 (P/R/N: 24623.54/50348.07/29615.47), change:5.239, time: 2.4s, batch: 712, fails: 0
    Epoch 18/99 - loss: 104081.24 (P/R/N: 25349.90/50228.62/28502.73), change:5.282, time: 2.3s, batch: 712, fails: 0
    Epoch 19/99 - loss: 103616.68 (P/R/N: 26065.79/50117.12/27433.78), change:5.270, time: 2.4s, batch: 712, fails: 0
    Epoch 20/99 - loss: 103148.25 (P/R/N: 26680.19/49960.04/26508.02), change:5.295, time: 2.4s, batch: 712, fails: 0
    Epoch 21/99 - loss: 102732.14 (P/R/N: 27297.04/49774.50/25660.60), change:5.290, time: 2.4s, batch: 712, fails: 0
    Epoch 22/99 - loss: 102295.95 (P/R/N: 27896.21/49608.52/24791.21), change:5.218, time: 2.4s, batch: 712, fails: 0
    Epoch 23/99 - loss: 101892.67 (P/R/N: 28466.25/49431.51/23994.90), change:5.212, time: 2.3s, batch: 712, fails: 0
    Epoch 24/99 - loss: 101534.59 (P/R/N: 29019.85/49260.22/23254.52), change:5.269, time: 2.4s, batch: 712, fails: 0
    Epoch 25/99 - loss: 101141.54 (P/R/N: 29535.50/49071.73/22534.30), change:5.285, time: 2.4s, batch: 712, fails: 0
    Epoch 26/99 - loss: 100820.11 (P/R/N: 30028.82/48846.88/21944.41), change:5.339, time: 2.4s, batch: 712, fails: 0
    Epoch 27/99 - loss: 100478.58 (P/R/N: 30529.05/48688.42/21261.11), change:5.264, time: 2.4s, batch: 712, fails: 0
    Epoch 28/99 - loss: 100149.45 (P/R/N: 30962.21/48454.02/20733.22), change:5.310, time: 2.4s, batch: 712, fails: 0
    Epoch 29/99 - loss: 99841.36 (P/R/N: 31417.61/48254.93/20168.80), change:5.369, time: 2.5s, batch: 712, fails: 0
    Epoch 30/99 - loss: 99549.50 (P/R/N: 31821.97/48019.39/19708.15), change:5.334, time: 2.4s, batch: 712, fails: 0
    Epoch 31/99 - loss: 99250.82 (P/R/N: 32253.43/47838.67/19158.72), change:5.470, time: 2.4s, batch: 712, fails: 0
    Epoch 32/99 - loss: 98973.84 (P/R/N: 32616.36/47580.93/18776.55), change:5.430, time: 2.3s, batch: 712, fails: 0
    Epoch 33/99 - loss: 98694.86 (P/R/N: 32998.64/47380.15/18316.07), change:5.477, time: 2.5s, batch: 712, fails: 0
    Epoch 34/99 - loss: 98439.99 (P/R/N: 33328.57/47128.37/17983.07), change:5.392, time: 2.5s, batch: 712, fails: 0
    Epoch 35/99 - loss: 98163.34 (P/R/N: 33678.37/46921.35/17563.64), change:5.527, time: 2.4s, batch: 712, fails: 0
    Epoch 36/99 - loss: 97944.16 (P/R/N: 34040.64/46717.09/17186.43), change:5.491, time: 2.4s, batch: 712, fails: 0
    Epoch 37/99 - loss: 97704.51 (P/R/N: 34353.67/46490.78/16860.07), change:5.555, time: 2.4s, batch: 712, fails: 0
    Epoch 38/99 - loss: 97444.74 (P/R/N: 34640.37/46243.26/16561.12), change:5.483, time: 2.3s, batch: 712, fails: 0
    Epoch 39/99 - loss: 97256.13 (P/R/N: 34962.93/46050.15/16243.05), change:5.650, time: 2.4s, batch: 712, fails: 0
    Epoch 40/99 - loss: 97032.49 (P/R/N: 35264.02/45841.78/15926.68), change:5.592, time: 2.4s, batch: 712, fails: 0
    Epoch 41/99 - loss: 96812.26 (P/R/N: 35541.77/45639.77/15630.73), change:5.626, time: 2.4s, batch: 712, fails: 0
    Epoch 42/99 - loss: 96584.83 (P/R/N: 35829.97/45425.77/15329.09), change:5.593, time: 2.3s, batch: 712, fails: 0
    Epoch 43/99 - loss: 96423.68 (P/R/N: 36086.61/45214.26/15122.82), change:5.688, time: 2.4s, batch: 712, fails: 0
    Epoch 44/99 - loss: 96197.09 (P/R/N: 36343.43/44986.88/14866.79), change:5.615, time: 2.4s, batch: 712, fails: 0
    Epoch 45/99 - loss: 95998.93 (P/R/N: 36604.60/44807.37/14586.96), change:5.627, time: 2.4s, batch: 712, fails: 0
    Epoch 46/99 - loss: 95802.68 (P/R/N: 36842.66/44590.64/14369.38), change:5.592, time: 2.4s, batch: 712, fails: 0
    Epoch 47/99 - loss: 95653.45 (P/R/N: 37101.99/44416.09/14135.36), change:5.682, time: 2.3s, batch: 712, fails: 0
    Epoch 48/99 - loss: 95441.36 (P/R/N: 37310.02/44203.88/13927.46), change:5.707, time: 2.4s, batch: 712, fails: 0
    Epoch 49/99 - loss: 95275.34 (P/R/N: 37547.93/44004.72/13722.71), change:5.770, time: 2.4s, batch: 712, fails: 0
    Epoch 50/99 - loss: 95087.41 (P/R/N: 37749.83/43791.61/13545.96), change:5.815, time: 2.4s, batch: 712, fails: 0
    Epoch 51/99 - loss: 94948.96 (P/R/N: 37967.52/43607.42/13374.01), change:5.782, time: 2.5s, batch: 712, fails: 0
    Epoch 52/99 - loss: 94781.30 (P/R/N: 38196.28/43442.52/13142.51), change:5.798, time: 2.3s, batch: 712, fails: 0
    Epoch 53/99 - loss: 94616.30 (P/R/N: 38408.19/43249.71/12958.40), change:6.003, time: 2.8s, batch: 712, fails: 0
    Epoch 54/99 - loss: 94457.67 (P/R/N: 38575.41/43030.29/12851.98), change:5.869, time: 2.4s, batch: 712, fails: 0
    Epoch 55/99 - loss: 94306.67 (P/R/N: 38796.69/42888.41/12621.57), change:5.953, time: 2.4s, batch: 712, fails: 0
    Epoch 56/99 - loss: 94158.05 (P/R/N: 38989.35/42695.19/12473.51), change:5.921, time: 2.4s, batch: 712, fails: 0
    Epoch 57/99 - loss: 94002.74 (P/R/N: 39153.62/42507.46/12341.65), change:5.980, time: 2.3s, batch: 712, fails: 0
    Epoch 58/99 - loss: 93875.95 (P/R/N: 39348.59/42333.08/12194.27), change:6.043, time: 2.4s, batch: 712, fails: 0
    Epoch 59/99 - loss: 93715.67 (P/R/N: 39513.98/42173.27/12028.42), change:6.064, time: 2.5s, batch: 712, fails: 0
    Epoch 60/99 - loss: 93593.91 (P/R/N: 39686.27/41985.52/11922.12), change:6.135, time: 2.4s, batch: 712, fails: 0
    Epoch 61/99 - loss: 93478.05 (P/R/N: 39880.68/41840.92/11756.45), change:6.038, time: 2.3s, batch: 712, fails: 0
    Epoch 62/99 - loss: 93309.20 (P/R/N: 40025.02/41653.29/11630.88), change:6.085, time: 2.5s, batch: 712, fails: 0
    Epoch 63/99 - loss: 93188.27 (P/R/N: 40203.14/41494.02/11491.11), change:6.220, time: 2.5s, batch: 712, fails: 0
    Epoch 64/99 - loss: 93067.17 (P/R/N: 40349.64/41326.83/11390.69), change:6.240, time: 2.4s, batch: 712, fails: 0
    Epoch 65/99 - loss: 92936.26 (P/R/N: 40504.58/41180.37/11251.31), change:6.247, time: 2.4s, batch: 712, fails: 0
    Epoch 66/99 - loss: 92821.41 (P/R/N: 40677.21/41021.49/11122.70), change:6.184, time: 2.4s, batch: 712, fails: 0
    Epoch 67/99 - loss: 92681.79 (P/R/N: 40811.77/40865.70/11004.32), change:6.263, time: 2.3s, batch: 712, fails: 0
    Epoch 68/99 - loss: 92586.27 (P/R/N: 40972.93/40709.90/10903.44), change:6.298, time: 2.4s, batch: 712, fails: 0
    Epoch 69/99 - loss: 92446.09 (P/R/N: 41101.18/40554.15/10790.77), change:6.323, time: 2.4s, batch: 712, fails: 0
    Epoch 70/99 - loss: 92347.89 (P/R/N: 41280.73/40432.48/10634.67), change:6.369, time: 2.4s, batch: 712, fails: 0
    Epoch 71/99 - loss: 92247.12 (P/R/N: 41429.25/40292.32/10525.54), change:6.352, time: 2.3s, batch: 712, fails: 0
    Epoch 72/99 - loss: 92130.66 (P/R/N: 41533.02/40096.67/10500.96), change:6.404, time: 2.4s, batch: 712, fails: 0
    Epoch 73/99 - loss: 92017.25 (P/R/N: 41687.63/40009.22/10320.38), change:6.423, time: 2.5s, batch: 712, fails: 0
    Epoch 74/99 - loss: 91908.98 (P/R/N: 41787.58/39788.88/10332.53), change:6.509, time: 2.5s, batch: 712, fails: 0
    Epoch 75/99 - loss: 91822.30 (P/R/N: 41948.11/39697.78/10176.43), change:6.509, time: 2.5s, batch: 712, fails: 0
    Epoch 76/99 - loss: 91701.99 (P/R/N: 42062.84/39556.05/10083.11), change:6.545, time: 2.3s, batch: 712, fails: 0
    Epoch 77/99 - loss: 91614.96 (P/R/N: 42209.44/39439.66/9965.85), change:6.519, time: 2.7s, batch: 712, fails: 0
    Epoch 78/99 - loss: 91509.97 (P/R/N: 42312.41/39282.86/9914.70), change:6.604, time: 2.4s, batch: 712, fails: 0
    Epoch 79/99 - loss: 91423.14 (P/R/N: 42439.43/39155.75/9827.96), change:6.662, time: 2.5s, batch: 712, fails: 0
    Epoch 80/99 - loss: 91322.17 (P/R/N: 42572.88/39046.29/9703.01), change:6.679, time: 2.5s, batch: 712, fails: 0
    Epoch 81/99 - loss: 91217.80 (P/R/N: 42678.68/38887.35/9651.78), change:6.690, time: 2.3s, batch: 712, fails: 0
    Epoch 82/99 - loss: 91137.37 (P/R/N: 42801.38/38769.04/9566.94), change:6.810, time: 2.4s, batch: 712, fails: 0
    Epoch 83/99 - loss: 91042.16 (P/R/N: 42906.50/38659.12/9476.55), change:6.708, time: 2.5s, batch: 712, fails: 0
    Epoch 84/99 - loss: 90938.30 (P/R/N: 43013.88/38499.47/9424.96), change:6.815, time: 2.4s, batch: 712, fails: 0
    Epoch 85/99 - loss: 90869.16 (P/R/N: 43150.28/38409.05/9309.83), change:6.774, time: 2.4s, batch: 712, fails: 0
    Epoch 86/99 - loss: 90785.86 (P/R/N: 43266.99/38287.01/9231.85), change:6.901, time: 2.3s, batch: 712, fails: 0
    Epoch 87/99 - loss: 90697.67 (P/R/N: 43368.63/38129.42/9199.62), change:6.892, time: 2.4s, batch: 712, fails: 0
    Epoch 88/99 - loss: 90607.82 (P/R/N: 43470.40/38021.15/9116.27), change:7.023, time: 2.4s, batch: 712, fails: 0
    Epoch 89/99 - loss: 90503.80 (P/R/N: 43571.16/37899.67/9032.98), change:7.002, time: 2.4s, batch: 712, fails: 0
    Epoch 90/99 - loss: 90432.45 (P/R/N: 43669.62/37778.83/8984.00), change:7.087, time: 2.3s, batch: 712, fails: 0
    Epoch 91/99 - loss: 90359.52 (P/R/N: 43782.75/37657.35/8919.42), change:7.096, time: 2.5s, batch: 712, fails: 0
    Epoch 92/99 - loss: 90261.41 (P/R/N: 43861.32/37542.79/8857.30), change:7.075, time: 2.5s, batch: 712, fails: 0
    Epoch 93/99 - loss: 90191.27 (P/R/N: 43976.31/37449.07/8765.89), change:7.116, time: 2.4s, batch: 712, fails: 0
    Epoch 94/99 - loss: 90112.34 (P/R/N: 44074.71/37303.12/8734.51), change:7.207, time: 2.4s, batch: 712, fails: 0
    Epoch 95/99 - loss: 90019.42 (P/R/N: 44167.30/37219.52/8632.61), change:7.212, time: 2.4s, batch: 712, fails: 0
    Epoch 96/99 - loss: 89964.37 (P/R/N: 44266.43/37092.52/8605.40), change:7.367, time: 2.3s, batch: 712, fails: 0
    Epoch 97/99 - loss: 89887.04 (P/R/N: 44383.59/36986.25/8517.18), change:7.295, time: 2.4s, batch: 712, fails: 0
    Epoch 98/99 - loss: 89818.08 (P/R/N: 44464.20/36875.45/8478.42), change:7.322, time: 2.4s, batch: 712, fails: 0
    Epoch 99/99 - loss: 89743.24 (P/R/N: 44561.89/36793.40/8387.95), change:7.376, time: 2.4s, batch: 712, fails: 0
Retrofit with '_get_retrofitted_embeds_v4_th' took 247.0s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.145
  Distance from negative 9745:   0.769

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1   6275 0.100  CD / LANA DEL REY / LUST FOR L  MUZICA  CD International
  2   1408 0.111  CD / QUEEN / THE PLATINUM COLL  MUZICA  CD International
  3  12238 0.115  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  4   1175 0.116  CD / QUEEN / GREATEST HITS (20  MUZICA  CD International
  5   4772 0.125  CD / MILES DAVIS / KIND OF BLU  MUZICA  CD International
  6   9991 0.130  CD / LED ZEPPELIN / REMASTERS   MUZICA  CD International
  7  12888 0.130  CD / EURYTHMICS / GREATEST HIT  MUZICA  CD International
  8   1032 0.134  CD / QUEEN / BOHEMIAN RHAPSODY  MUZICA  CD International
  9   2386 0.135  CD / PINK FLOYD / THE WALL (Re  MUZICA  CD International
================================================================================================
================================================================================================
== Iteration 2: ================================================================================
================================================================================================
{'method': 'v5_tf', 'batch_size': 1024, 'dist': 'l1'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v5_tf
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v5_tf()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing model...
  Preparing dataset...
  Training model for 99 epochs, batch=1024, lr=1.0e-01, tol=1.0e-03, dist=l1, neg_margin=128
    Epoch 01/99 - loss: 124537.34, change:25.425, time: 12.9s, batch: 1024, fails: 0
    Epoch 02/99 - loss: 122734.14, change:14.760, time: 11.3s, batch: 1024, fails: 0
    Epoch 03/99 - loss: 118314.98, change:12.887, time: 11.4s, batch: 1024, fails: 0
    Epoch 04/99 - loss: 114950.05, change:12.227, time: 11.6s, batch: 1024, fails: 0
    Epoch 05/99 - loss: 112595.16, change:11.914, time: 12.0s, batch: 1024, fails: 0
    Epoch 06/99 - loss: 110529.88, change:11.303, time: 11.3s, batch: 1024, fails: 0
    Epoch 07/99 - loss: 109001.62, change:11.486, time: 11.4s, batch: 1024, fails: 0
    Epoch 08/99 - loss: 107560.46, change:11.242, time: 11.3s, batch: 1024, fails: 0
    Epoch 09/99 - loss: 106478.29, change:10.955, time: 11.6s, batch: 1024, fails: 0
    Epoch 10/99 - loss: 105402.03, change:10.685, time: 11.8s, batch: 1024, fails: 0
    Epoch 11/99 - loss: 104532.91, change:15.806, time: 11.3s, batch: 1024, fails: 0
    Epoch 12/99 - loss: 103667.09, change:12.438, time: 11.3s, batch: 1024, fails: 0
    Epoch 13/99 - loss: 102849.05, change:10.557, time: 11.2s, batch: 1024, fails: 0
    Epoch 14/99 - loss: 102108.33, change:10.647, time: 11.4s, batch: 1024, fails: 0
    Epoch 15/99 - loss: 101463.88, change:10.640, time: 11.8s, batch: 1024, fails: 0
    Epoch 16/99 - loss: 100802.48, change:12.534, time: 11.3s, batch: 1024, fails: 0
    Epoch 17/99 - loss: 100284.53, change:15.691, time: 11.6s, batch: 1024, fails: 0
    Epoch 18/99 - loss: 99704.95, change:10.893, time: 11.3s, batch: 1024, fails: 0
    Epoch 19/99 - loss: 99168.71, change:10.530, time: 11.5s, batch: 1024, fails: 0
    Epoch 20/99 - loss: 98673.38, change:11.790, time: 12.1s, batch: 1024, fails: 0
    Epoch 21/99 - loss: 98199.05, change:10.538, time: 13.0s, batch: 1024, fails: 0
    Epoch 22/99 - loss: 97759.23, change:10.667, time: 12.7s, batch: 1024, fails: 0
    Epoch 23/99 - loss: 97310.30, change:12.328, time: 11.3s, batch: 1024, fails: 0
    Epoch 24/99 - loss: 96933.54, change:12.594, time: 11.8s, batch: 1024, fails: 0
    Epoch 25/99 - loss: 96501.71, change:10.713, time: 13.8s, batch: 1024, fails: 0
    Epoch 26/99 - loss: 96148.37, change:10.734, time: 11.9s, batch: 1024, fails: 0
    Epoch 27/99 - loss: 95782.91, change:10.945, time: 11.7s, batch: 1024, fails: 0
    Epoch 28/99 - loss: 95482.30, change:13.420, time: 11.5s, batch: 1024, fails: 0
    Epoch 29/99 - loss: 95131.23, change:10.866, time: 11.4s, batch: 1024, fails: 0
    Epoch 30/99 - loss: 94861.77, change:11.005, time: 11.7s, batch: 1024, fails: 0
    Epoch 31/99 - loss: 94490.22, change:11.094, time: 11.4s, batch: 1024, fails: 0
    Epoch 32/99 - loss: 94202.16, change:11.378, time: 13.0s, batch: 1024, fails: 0
    Epoch 33/99 - loss: 93951.95, change:12.984, time: 11.6s, batch: 1024, fails: 0
    Epoch 34/99 - loss: 93727.13, change:11.348, time: 12.2s, batch: 1024, fails: 0
    Epoch 35/99 - loss: 93368.25, change:11.401, time: 11.9s, batch: 1024, fails: 0
    Epoch 36/99 - loss: 93193.21, change:12.489, time: 11.3s, batch: 1024, fails: 0
    Epoch 37/99 - loss: 92937.46, change:11.598, time: 11.3s, batch: 1024, fails: 0
    Epoch 38/99 - loss: 92727.33, change:11.828, time: 11.4s, batch: 1024, fails: 0
    Epoch 39/99 - loss: 92446.14, change:11.819, time: 11.3s, batch: 1024, fails: 0
    Epoch 40/99 - loss: 92288.13, change:16.308, time: 11.9s, batch: 1024, fails: 0
    Epoch 41/99 - loss: 92015.84, change:11.859, time: 11.2s, batch: 1024, fails: 0
    Epoch 42/99 - loss: 91864.45, change:12.148, time: 11.4s, batch: 1024, fails: 0
    Epoch 43/99 - loss: 91580.11, change:12.039, time: 11.4s, batch: 1024, fails: 0
    Epoch 44/99 - loss: 91476.84, change:12.327, time: 11.4s, batch: 1024, fails: 0
    Epoch 45/99 - loss: 91194.45, change:12.199, time: 11.6s, batch: 1024, fails: 0
    Epoch 46/99 - loss: 91081.20, change:12.305, time: 12.9s, batch: 1024, fails: 0
    Epoch 47/99 - loss: 90855.16, change:12.641, time: 11.6s, batch: 1024, fails: 0
    Epoch 48/99 - loss: 90744.41, change:12.774, time: 12.1s, batch: 1024, fails: 0
    Epoch 49/99 - loss: 90547.08, change:12.586, time: 12.2s, batch: 1024, fails: 0
    Epoch 50/99 - loss: 90351.54, change:13.087, time: 13.4s, batch: 1024, fails: 0
    Epoch 51/99 - loss: 90195.42, change:13.115, time: 12.5s, batch: 1024, fails: 0
    Epoch 52/99 - loss: 90101.16, change:14.045, time: 11.3s, batch: 1024, fails: 0
    Epoch 53/99 - loss: 89874.77, change:13.227, time: 11.4s, batch: 1024, fails: 0
    Epoch 54/99 - loss: 89786.55, change:13.549, time: 11.4s, batch: 1024, fails: 0
    Epoch 55/99 - loss: 89578.16, change:13.546, time: 11.7s, batch: 1024, fails: 0
    Epoch 56/99 - loss: 89484.91, change:13.719, time: 11.7s, batch: 1024, fails: 0
    Epoch 57/99 - loss: 89269.26, change:13.640, time: 11.4s, batch: 1024, fails: 0
    Epoch 58/99 - loss: 89206.45, change:13.880, time: 11.3s, batch: 1024, fails: 0
    Epoch 59/99 - loss: 89033.95, change:14.091, time: 11.3s, batch: 1024, fails: 0
    Epoch 60/99 - loss: 88934.95, change:14.221, time: 11.5s, batch: 1024, fails: 0
    Epoch 61/99 - loss: 88773.13, change:14.211, time: 11.7s, batch: 1024, fails: 0
    Epoch 62/99 - loss: 88721.72, change:14.561, time: 11.4s, batch: 1024, fails: 0
    Epoch 63/99 - loss: 88559.13, change:14.659, time: 11.3s, batch: 1024, fails: 0
    Epoch 64/99 - loss: 88502.45, change:15.857, time: 11.3s, batch: 1024, fails: 0
    Epoch 65/99 - loss: 88340.41, change:14.845, time: 11.3s, batch: 1024, fails: 0
    Epoch 66/99 - loss: 88239.68, change:15.155, time: 11.7s, batch: 1024, fails: 0
    Epoch 67/99 - loss: 88147.67, change:15.004, time: 11.3s, batch: 1024, fails: 0
    Epoch 68/99 - loss: 88024.98, change:15.201, time: 11.3s, batch: 1024, fails: 0
