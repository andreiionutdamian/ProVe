Metatada information:
  Total no of products: 13000
  Total no of level 1 hierarchies: 24
  Total no of level 2 hierarchies: 181
  Most sold individual product over period:
   Name:  YUVAL NOAH HARARI / SAPIENS. SCURTA ISTORIE A OMENIRII
   Id:    545535
   Freq:  21248
   Hrchy: 1/17
  Least sold individual product over period:
   Name:  DAVID GROSSMAN / UN CAL INTRA ÎNTR-UN BAR
   Id:    442552
   Freq:  156
   Hrchy: 1/0
Loading MCO...
Loading raw data...
  MCO Processing done in 0.08 min (sparse mat creation: 0.08 min):
  Start date: None
  End date:   None
  Max co-occ: 5998.0

**Co-occurence distribution:**
    Counts: 00 6382178 913964 293414 138452 77970 49730 34124 24904 18758
    Values:  0       1      2      3      4     5     6     7     8     9

**Transactions size distribution:**
    Counts: 00 00 1210270 484388 194496 86254 41847 21134 11616 6430
    Values:  0  1       2      3      4     5     6     7     8    9

**Transactional data structure:**
    RangeIndex: 5767223 entries, 0 to 5767222
    Data columns (total 8 columns):
     #   Column     Dtype  
    ---  ------     -----  
     0   BasketId   int64  
     1   ItemId     int64  
     2   SiteId     int64  
     3   TimeStamp  object 
     4   Qtty       float64
     5   ClientId   int64  
     6   IsActive   int64  
     7   IDE        int64  
    dtypes: float64(1), int64(6), object(1)
    memory usage: 352.0+ MB


MCO data: (only 7x7 values displayed)
    [[   0.   25.   49. 5998.  297.   85.   28.]
     [  25.    0.   32.   19.    6.    9.   15.]
     [  49.   32.    0.   22.    8.   15.   28.]
     [5998.   19.   22.    0.  165.   42.   13.]
     [ 297.    6.    8.  165.    0.  141.   11.]
     [  85.    9.   15.   42.  141.    0.   11.]
     [  28.   15.   28.   13.   11.   11.    0.]]
Saving 'exp_models\exp_mco.npz'
*Hierarchy level 1 'Ierarhie1' contains 32 categories*
  Category name: ACCESORII GASTRO AA  Id:   9  Prods:  523
  Category name: ALTELE               Id:  26  Prods:    9
  Category name: CARTE ROM            Id:   1  Prods: 7202
  Category name: CARTE STRAINA        Id:   0  Prods:  736
  ...
*Hierarchy level 2 'Ierarhie2' contains 356 categories*
  Category name: ACCESORII              Id: 116  Prods:    3
  Category name: ACCESORII FASHION      Id: 274  Prods:   21
  Category name: ACCESORII MASA         Id: 249  Prods:   26
  Category name: ALTELE                 Id:  60  Prods:   60
  ...
Loading GloVe word embeddings
Top neighbors for 9440: 'beatles':
  beatles:    0.000
  lennon:     0.246
  mccartney:  0.276
  dylan:      0.304
  songs:      0.305
  recordings: 0.325
  albums:     0.326
  elvis:      0.326
  motown:     0.327
  presley:    0.333
*Hierarchy level 1 'Ierarhie1' contains 8 categories*
  Category name: COMICS&MANGA  Id:  21  Prods:  135
  Category name: GASTRONOMIE   Id:  20  Prods:  196
  Category name: HOME&DECO AA  Id:  10  Prods:  174
  Category name: LIFESTYLE     Id:  12  Prods:  239
  Category name: MULTIMEDIA    Id:   8  Prods:  411
  Category name: MUZICA        Id:   2  Prods:  219
  Category name: NOVELTY       Id:  23  Prods:  103
  Category name: VINURI        Id:  14  Prods:   23
*Hierarchy level 2 'Ierarhie2' contains 14 categories*
  Category name: Audiobook CD           Id: 111  Prods:    7
  Category name: BLU-RAY                Id:  36  Prods:   16
  Category name: BOARD GAMES            Id: 140  Prods:  165
  Category name: Backtoschool           Id: 108  Prods:   16
  Category name: Bakery                 Id: 269  Prods:   10
  Category name: COMICS                 Id:  87  Prods:    3
  Category name: Comics                 Id: 120  Prods:   23
  Category name: FILOSOFIE              Id:  43  Prods:  144
  Category name: Giftware               Id: 107  Prods:   95
  Category name: LIFESTYLE              Id: 283  Prods:   11
  Category name: MANGA                  Id:  63  Prods:   87
  Category name: Travel Mug             Id: 144  Prods:   66
  Category name: Travelling collection  Id:  75  Prods:   19
  Category name: Vinyl                  Id:  10  Prods:   52
Initializing Embeddings processing Engine v0.1.0.1.
Preparing product dicts
Found category string in 'Ierarhie1_name'
Found category string in 'Ierarhie2_name'
Item knowledge graph loaded.		

Product '12071' info:
  NAME: CD / DAVID BOWIE / BLACKSTAR (
  Ierarhie1: 2
  Ierarhie1_name: MUZICA
  Ierarhie2: 4
  Ierarhie2_name: CD International
  POS_EDGES (102 items):
             IDE                        ItemName Ierarhie1_name    Ierarhie2_name  Ierarhie1  Ierarhie2
    1032    1032  CD / QUEEN / BOHEMIAN RHAPSODY         MUZICA  CD International          2          4
    10780  10780  CD / TWENTY ONE PILOTS / TRENC         MUZICA  CD International          2          4
    11834  11834   CD / NIRVANA / NIRVANA (2002)         MUZICA  CD International          2          4
    11326  11326  CD / SELENA GOMEZ / REVIVAL (D         MUZICA  CD International          2          4
    12862  12862  CD / DREAM THEATER / THE TRIPL         MUZICA  CD International          2          4
  NEG_EDGES (6 items):
             IDE                        ItemName       Ierarhie1_name                     Ierarhie2_name  Ierarhie1  Ierarhie2
    8392    8392                13.2X2.5CM PLATE  ACCESORII GASTRO AA              Accesorii servit masa          9         16
    12266  12266  TIM DEDOPULOS / HERCULE POIROT            CARTE ROM               PRACTIC / TIMP LIBER          1         30
    4400    4400  CARTEA SARUTURILOR / IV CEL NA            CARTE ROM  POEZIE / TEATRU / STUDII LITERARE          1          2
    9745    9745  MASINI DIE-CAST 7.5cm III ASST              JUCARII                            JUCARII          4         73
    10135  10135  BUCATARIE ITALIANA 100 DE RETE            CARTE ROM                        GASTRONOMIE          1         78

  Table: Non-filtered neighbors of 12071 using exp_v4es_033.npy model
        ID  DIST                            NAME               H1                    H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (           MUZICA      CD International
  1  11418 0.644  CD / DAVID BOWIE / BEST OF BOW           MUZICA      CD International
  2   4416 0.645  CD / COLDPLAY / 4 CD CATALOGUE           MUZICA      CD International
  3   4865 0.663  CD / COLDPLAY / A HEAD FULL OF           MUZICA      CD International
  4   9745 0.665  MASINI DIE-CAST 7.5cm III ASST          JUCARII               JUCARII
  5   7933 0.675     CUVINTE INCRUCISATE/ IQ FUN        CARTE ROM    CARTI PENTRU COPII
  6   8392 0.676                13.2X2.5CM PLATE  ACCESORII GASTR  Accesorii servit mas
  7  10135 0.678  BUCATARIE ITALIANA 100 DE RETE        CARTE ROM           GASTRONOMIE
  8   4400 0.682  CARTEA SARUTURILOR / IV CEL NA        CARTE ROM  POEZIE / TEATRU / ST
  9  12266 0.697  TIM DEDOPULOS / HERCULE POIROT        CARTE ROM  PRACTIC / TIMP LIBER
================================================================================================
================================================================================================
== Iteration 1: ================================================================================
================================================================================================
{'method': 'v4_th', 'batch_size': 256, 'dist': 'l1'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v4_th
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v4_th()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing torch model...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, negative margin: 128, dist=l1, fixed_weights=None
    Epoch 01/99 - loss: 31544.51 (P/R/N: 539.52/13498.73/17506.27), change:14.872, time: 2.7s, batch: 256, fails: 0
    Epoch 02/99 - loss: 31227.15 (P/R/N: 1633.00/13484.47/16109.68), change:9.759, time: 2.5s, batch: 256, fails: 0
    Epoch 03/99 - loss: 30599.00 (P/R/N: 2180.38/13060.53/15358.09), change:6.747, time: 2.5s, batch: 256, fails: 0
    Epoch 04/99 - loss: 30043.37 (P/R/N: 2552.50/12978.66/14512.21), change:6.359, time: 2.5s, batch: 256, fails: 0
    Epoch 05/99 - loss: 29587.93 (P/R/N: 2958.50/12923.74/13705.69), change:6.295, time: 2.5s, batch: 256, fails: 0
    Epoch 06/99 - loss: 29161.94 (P/R/N: 3334.02/12902.31/12925.61), change:6.010, time: 2.8s, batch: 256, fails: 0
    Epoch 07/99 - loss: 28810.09 (P/R/N: 3707.65/12902.56/12199.88), change:6.038, time: 2.5s, batch: 256, fails: 0
    Epoch 08/99 - loss: 28470.17 (P/R/N: 4027.89/12894.50/11547.77), change:5.708, time: 2.5s, batch: 256, fails: 0
    Epoch 09/99 - loss: 28197.65 (P/R/N: 4361.02/12918.05/10918.59), change:5.600, time: 2.7s, batch: 256, fails: 0
    Epoch 10/99 - loss: 27933.44 (P/R/N: 4647.53/12911.13/10374.78), change:5.508, time: 2.5s, batch: 256, fails: 0
    Epoch 11/99 - loss: 27705.34 (P/R/N: 4928.66/12917.80/9858.87), change:5.437, time: 2.6s, batch: 256, fails: 0
    Epoch 12/99 - loss: 27490.73 (P/R/N: 5184.56/12913.00/9393.16), change:5.378, time: 2.5s, batch: 256, fails: 0
    Epoch 13/99 - loss: 27295.83 (P/R/N: 5435.49/12915.63/8944.71), change:5.316, time: 2.7s, batch: 256, fails: 0
    Epoch 14/99 - loss: 27119.15 (P/R/N: 5673.90/12904.20/8541.05), change:5.346, time: 2.5s, batch: 256, fails: 0
    Epoch 15/99 - loss: 26954.78 (P/R/N: 5888.15/12886.12/8180.50), change:5.296, time: 2.5s, batch: 256, fails: 0
    Epoch 16/99 - loss: 26802.41 (P/R/N: 6092.27/12865.00/7845.14), change:5.244, time: 2.6s, batch: 256, fails: 0
    Epoch 17/99 - loss: 26663.68 (P/R/N: 6292.75/12836.13/7534.79), change:5.200, time: 2.6s, batch: 256, fails: 0
    Epoch 18/99 - loss: 26531.24 (P/R/N: 6474.56/12803.79/7252.90), change:5.209, time: 2.5s, batch: 256, fails: 0
    Epoch 19/99 - loss: 26409.73 (P/R/N: 6646.17/12763.64/6999.92), change:5.203, time: 2.5s, batch: 256, fails: 0
    Epoch 20/99 - loss: 26292.60 (P/R/N: 6817.08/12726.65/6748.86), change:5.158, time: 2.7s, batch: 256, fails: 0
    Epoch 21/99 - loss: 26182.91 (P/R/N: 6978.77/12693.38/6510.75), change:5.152, time: 2.5s, batch: 256, fails: 0
    Epoch 22/99 - loss: 26077.77 (P/R/N: 7126.44/12649.52/6301.82), change:5.140, time: 2.6s, batch: 256, fails: 0
    Epoch 23/99 - loss: 25974.75 (P/R/N: 7276.09/12601.62/6097.04), change:5.222, time: 2.5s, batch: 256, fails: 0
    Epoch 24/99 - loss: 25876.74 (P/R/N: 7415.02/12552.02/5909.70), change:5.304, time: 2.7s, batch: 256, fails: 0
    Epoch 25/99 - loss: 25785.49 (P/R/N: 7547.96/12502.30/5735.23), change:5.254, time: 2.5s, batch: 256, fails: 0
    Epoch 26/99 - loss: 25690.97 (P/R/N: 7676.41/12454.88/5559.68), change:5.252, time: 2.5s, batch: 256, fails: 0
    Epoch 27/99 - loss: 25605.74 (P/R/N: 7797.00/12400.11/5408.63), change:5.226, time: 2.5s, batch: 256, fails: 0
    Epoch 28/99 - loss: 25526.15 (P/R/N: 7910.68/12343.30/5272.17), change:5.266, time: 2.5s, batch: 256, fails: 0
    Epoch 29/99 - loss: 25442.24 (P/R/N: 8020.56/12289.24/5132.44), change:5.265, time: 2.8s, batch: 256, fails: 0
    Epoch 30/99 - loss: 25370.79 (P/R/N: 8132.88/12236.55/5001.36), change:5.278, time: 2.7s, batch: 256, fails: 0
    Epoch 31/99 - loss: 25294.31 (P/R/N: 8233.45/12179.85/4881.01), change:5.294, time: 2.7s, batch: 256, fails: 0
    Epoch 32/99 - loss: 25225.33 (P/R/N: 8331.69/12119.90/4773.74), change:5.293, time: 2.7s, batch: 256, fails: 0
    Epoch 33/99 - loss: 25151.44 (P/R/N: 8425.05/12063.75/4662.64), change:5.392, time: 2.5s, batch: 256, fails: 0
    Epoch 34/99 - loss: 25087.96 (P/R/N: 8514.39/12003.76/4569.81), change:5.326, time: 2.5s, batch: 256, fails: 0
    Epoch 35/99 - loss: 25023.76 (P/R/N: 8606.37/11951.86/4465.53), change:5.375, time: 2.6s, batch: 256, fails: 0
    Epoch 36/99 - loss: 24959.71 (P/R/N: 8686.82/11888.77/4384.11), change:5.415, time: 2.7s, batch: 256, fails: 0
    Epoch 37/99 - loss: 24897.43 (P/R/N: 8771.26/11839.33/4286.84), change:5.400, time: 2.6s, batch: 256, fails: 0
    Epoch 38/99 - loss: 24842.67 (P/R/N: 8854.09/11789.20/4199.39), change:5.386, time: 2.6s, batch: 256, fails: 0
    Epoch 39/99 - loss: 24784.18 (P/R/N: 8926.16/11725.53/4132.49), change:5.409, time: 2.5s, batch: 256, fails: 0
    Epoch 40/99 - loss: 24726.23 (P/R/N: 9002.38/11675.01/4048.84), change:5.444, time: 2.6s, batch: 256, fails: 0
    Epoch 41/99 - loss: 24669.61 (P/R/N: 9073.39/11616.75/3979.47), change:5.509, time: 2.5s, batch: 256, fails: 0
    Epoch 42/99 - loss: 24621.71 (P/R/N: 9146.07/11563.46/3912.19), change:5.458, time: 2.7s, batch: 256, fails: 0
    Epoch 43/99 - loss: 24570.16 (P/R/N: 9217.24/11511.70/3841.23), change:5.476, time: 2.7s, batch: 256, fails: 0
    Epoch 44/99 - loss: 24517.22 (P/R/N: 9277.68/11460.94/3778.61), change:5.517, time: 2.6s, batch: 256, fails: 0
    Epoch 45/99 - loss: 24465.66 (P/R/N: 9344.48/11407.82/3713.37), change:5.677, time: 2.5s, batch: 256, fails: 0
    Epoch 46/99 - loss: 24425.95 (P/R/N: 9412.29/11361.57/3652.08), change:5.632, time: 2.5s, batch: 256, fails: 0
    Epoch 47/99 - loss: 24371.62 (P/R/N: 9474.68/11308.47/3588.47), change:5.635, time: 2.8s, batch: 256, fails: 0
    Epoch 48/99 - loss: 24330.25 (P/R/N: 9527.37/11254.12/3548.76), change:5.674, time: 2.5s, batch: 256, fails: 0
    Epoch 49/99 - loss: 24280.79 (P/R/N: 9586.61/11208.70/3485.47), change:5.704, time: 2.6s, batch: 256, fails: 0
    Epoch 50/99 - loss: 24238.73 (P/R/N: 9642.10/11151.17/3445.47), change:5.663, time: 2.5s, batch: 256, fails: 0
    Epoch 51/99 - loss: 24197.75 (P/R/N: 9700.96/11109.78/3387.00), change:5.709, time: 2.6s, batch: 256, fails: 0
    Epoch 52/99 - loss: 24153.27 (P/R/N: 9751.94/11059.33/3342.00), change:5.659, time: 2.8s, batch: 256, fails: 0
    Epoch 53/99 - loss: 24111.71 (P/R/N: 9805.82/11008.48/3297.41), change:5.692, time: 2.5s, batch: 256, fails: 0
    Epoch 54/99 - loss: 24071.71 (P/R/N: 9851.99/10957.06/3262.66), change:5.746, time: 2.6s, batch: 256, fails: 0
    Epoch 55/99 - loss: 24034.23 (P/R/N: 9897.59/10912.93/3223.71), change:5.742, time: 2.7s, batch: 256, fails: 0
    Epoch 56/99 - loss: 23994.16 (P/R/N: 9951.82/10871.93/3170.42), change:5.799, time: 2.6s, batch: 256, fails: 0
    Epoch 57/99 - loss: 23957.04 (P/R/N: 10002.64/10825.93/3128.47), change:5.842, time: 2.5s, batch: 256, fails: 0
    Epoch 58/99 - loss: 23922.23 (P/R/N: 10049.98/10779.06/3093.19), change:5.908, time: 2.6s, batch: 256, fails: 0
    Epoch 59/99 - loss: 23884.99 (P/R/N: 10094.61/10735.39/3054.99), change:5.913, time: 2.7s, batch: 256, fails: 0
    Epoch 60/99 - loss: 23852.87 (P/R/N: 10137.84/10691.18/3023.85), change:5.918, time: 2.6s, batch: 256, fails: 0
    Epoch 61/99 - loss: 23810.37 (P/R/N: 10179.48/10649.53/2981.37), change:5.956, time: 2.6s, batch: 256, fails: 0
    Epoch 62/99 - loss: 23780.13 (P/R/N: 10223.08/10601.01/2956.04), change:6.056, time: 2.5s, batch: 256, fails: 0
    Epoch 63/99 - loss: 23743.94 (P/R/N: 10262.01/10559.86/2922.08), change:6.039, time: 2.7s, batch: 256, fails: 0
    Epoch 64/99 - loss: 23716.67 (P/R/N: 10307.85/10520.69/2888.13), change:6.085, time: 2.5s, batch: 256, fails: 0
    Epoch 65/99 - loss: 23685.81 (P/R/N: 10347.35/10479.37/2859.09), change:6.099, time: 2.5s, batch: 256, fails: 0
    Epoch 66/99 - loss: 23651.86 (P/R/N: 10385.97/10445.50/2820.40), change:6.069, time: 2.7s, batch: 256, fails: 0
    Epoch 67/99 - loss: 23619.49 (P/R/N: 10416.96/10394.64/2807.89), change:6.122, time: 2.5s, batch: 256, fails: 0
    Epoch 68/99 - loss: 23588.05 (P/R/N: 10459.84/10357.20/2771.01), change:6.163, time: 2.5s, batch: 256, fails: 0
    Epoch 69/99 - loss: 23561.29 (P/R/N: 10500.47/10318.11/2742.72), change:6.152, time: 2.5s, batch: 256, fails: 0
    Epoch 70/99 - loss: 23527.35 (P/R/N: 10537.22/10279.68/2710.46), change:6.207, time: 2.7s, batch: 256, fails: 0
    Epoch 71/99 - loss: 23505.73 (P/R/N: 10569.83/10241.24/2694.65), change:6.213, time: 2.5s, batch: 256, fails: 0
    Epoch 72/99 - loss: 23476.90 (P/R/N: 10604.89/10206.08/2665.93), change:6.220, time: 2.6s, batch: 256, fails: 0
    Epoch 73/99 - loss: 23449.59 (P/R/N: 10642.43/10175.66/2631.50), change:6.209, time: 2.5s, batch: 256, fails: 0
    Epoch 74/99 - loss: 23424.56 (P/R/N: 10680.19/10141.56/2602.81), change:6.250, time: 2.8s, batch: 256, fails: 0
    Epoch 75/99 - loss: 23395.03 (P/R/N: 10706.39/10102.71/2585.92), change:6.310, time: 2.6s, batch: 256, fails: 0
    Epoch 76/99 - loss: 23369.91 (P/R/N: 10745.26/10070.78/2553.88), change:6.387, time: 2.6s, batch: 256, fails: 0
    Epoch 77/99 - loss: 23343.92 (P/R/N: 10775.05/10034.67/2534.20), change:6.367, time: 2.5s, batch: 256, fails: 0
    Epoch 78/99 - loss: 23323.32 (P/R/N: 10805.46/9997.27/2520.58), change:6.454, time: 2.7s, batch: 256, fails: 0
    Epoch 79/99 - loss: 23293.39 (P/R/N: 10838.25/9967.99/2487.15), change:6.443, time: 2.6s, batch: 256, fails: 0
    Epoch 80/99 - loss: 23273.44 (P/R/N: 10866.51/9933.23/2473.70), change:6.466, time: 2.5s, batch: 256, fails: 0
    Epoch 81/99 - loss: 23247.95 (P/R/N: 10900.98/9900.33/2446.64), change:6.420, time: 2.6s, batch: 256, fails: 0
    Epoch 82/99 - loss: 23220.24 (P/R/N: 10925.03/9861.04/2434.17), change:6.560, time: 2.8s, batch: 256, fails: 0
    Epoch 83/99 - loss: 23204.95 (P/R/N: 10961.47/9839.02/2404.46), change:6.585, time: 2.6s, batch: 256, fails: 0
    Epoch 84/99 - loss: 23174.40 (P/R/N: 10987.80/9803.04/2383.55), change:6.591, time: 2.5s, batch: 256, fails: 0
    Epoch 85/99 - loss: 23156.12 (P/R/N: 11017.85/9772.29/2365.98), change:6.673, time: 2.6s, batch: 256, fails: 0
    Epoch 86/99 - loss: 23132.03 (P/R/N: 11039.24/9743.02/2349.77), change:6.807, time: 2.6s, batch: 256, fails: 0
    Epoch 87/99 - loss: 23109.88 (P/R/N: 11069.85/9711.64/2328.39), change:6.804, time: 2.7s, batch: 256, fails: 0
    Epoch 88/99 - loss: 23087.45 (P/R/N: 11094.56/9680.08/2312.81), change:6.816, time: 2.7s, batch: 256, fails: 0
    Epoch 89/99 - loss: 23066.73 (P/R/N: 11122.85/9650.81/2293.07), change:6.736, time: 2.9s, batch: 256, fails: 0
    Epoch 90/99 - loss: 23044.53 (P/R/N: 11145.80/9618.06/2280.67), change:6.799, time: 2.6s, batch: 256, fails: 0
    Epoch 91/99 - loss: 23025.71 (P/R/N: 11170.81/9590.50/2264.40), change:6.840, time: 2.5s, batch: 256, fails: 0
    Epoch 92/99 - loss: 23007.01 (P/R/N: 11204.73/9564.35/2237.93), change:6.913, time: 2.6s, batch: 256, fails: 0
    Epoch 93/99 - loss: 22987.12 (P/R/N: 11226.31/9530.02/2230.79), change:6.836, time: 2.8s, batch: 256, fails: 0
    Epoch 94/99 - loss: 22969.38 (P/R/N: 11253.88/9506.15/2209.34), change:6.855, time: 2.5s, batch: 256, fails: 0
    Epoch 95/99 - loss: 22940.69 (P/R/N: 11268.39/9468.86/2203.44), change:7.030, time: 2.5s, batch: 256, fails: 0
    Epoch 96/99 - loss: 22926.68 (P/R/N: 11302.20/9450.21/2174.27), change:7.019, time: 2.6s, batch: 256, fails: 0
    Epoch 97/99 - loss: 22906.16 (P/R/N: 11326.86/9421.01/2158.29), change:7.006, time: 3.0s, batch: 256, fails: 0
    Epoch 98/99 - loss: 22887.62 (P/R/N: 11353.97/9392.08/2141.57), change:7.054, time: 2.5s, batch: 256, fails: 0
    Epoch 99/99 - loss: 22875.78 (P/R/N: 11378.32/9363.78/2133.68), change:7.035, time: 2.5s, batch: 256, fails: 0
Retrofit with '_get_retrofitted_embeds_v4_th' took 264.8s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.170
  Distance from negative 9745:   0.740

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1   6275 0.123  CD / LANA DEL REY / LUST FOR L  MUZICA  CD International
  2  12238 0.133  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  3   1175 0.141  CD / QUEEN / GREATEST HITS (20  MUZICA  CD International
  4   1408 0.147  CD / QUEEN / THE PLATINUM COLL  MUZICA  CD International
  5  12888 0.150  CD / EURYTHMICS / GREATEST HIT  MUZICA  CD International
  6  10967 0.154  CD / JULIO IGLESIAS / THE ESSE  MUZICA  CD International
  7   7004 0.155  CD / PINK MARTINI / JE DIS OUI  MUZICA  CD International
  8  12225 0.156  CD / FRANK SINATRA / NOTHING B  MUZICA  CD International
  9   9991 0.157  CD / LED ZEPPELIN / REMASTERS   MUZICA  CD International
================================================================================================
================================================================================================
== Iteration 2: ================================================================================
================================================================================================
{'method': 'v4_th', 'batch_size': 256, 'dist': 'l2'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v4_th
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v4_th()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing torch model...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, negative margin: 128, dist=l2, fixed_weights=None
    Epoch 01/99 - loss: 30614.23 (P/R/N: 27.90/8697.27/21889.05), change:14.771, time: 2.8s, batch: 256, fails: 0
    Epoch 02/99 - loss: 28128.54 (P/R/N: 238.97/7785.43/20104.14), change:12.011, time: 2.7s, batch: 256, fails: 0
    Epoch 03/99 - loss: 25861.97 (P/R/N: 665.56/7620.17/17576.24), change:13.980, time: 2.7s, batch: 256, fails: 0
    Epoch 04/99 - loss: 23624.87 (P/R/N: 1292.41/7967.39/14365.07), change:15.416, time: 2.7s, batch: 256, fails: 0
    Epoch 05/99 - loss: 21557.48 (P/R/N: 2000.56/8410.77/11146.14), change:16.840, time: 3.1s, batch: 256, fails: 0
    Epoch 06/99 - loss: 19827.25 (P/R/N: 2764.48/8802.19/8260.57), change:17.957, time: 2.7s, batch: 256, fails: 0
    Epoch 07/99 - loss: 18430.16 (P/R/N: 3474.31/8915.95/6039.90), change:18.812, time: 2.9s, batch: 256, fails: 0
    Epoch 08/99 - loss: 17311.88 (P/R/N: 4092.97/8767.08/4451.83), change:19.646, time: 2.9s, batch: 256, fails: 0
    Epoch 09/99 - loss: 16382.09 (P/R/N: 4634.69/8433.79/3313.60), change:20.031, time: 3.0s, batch: 256, fails: 0
    Epoch 10/99 - loss: 15603.03 (P/R/N: 5101.62/7970.03/2531.38), change:20.624, time: 2.7s, batch: 256, fails: 0
    Epoch 11/99 - loss: 14957.90 (P/R/N: 5518.17/7452.39/1987.33), change:21.067, time: 2.7s, batch: 256, fails: 0
    Epoch 12/99 - loss: 14393.40 (P/R/N: 5891.38/6906.35/1595.67), change:21.036, time: 2.8s, batch: 256, fails: 0
    Epoch 13/99 - loss: 13900.99 (P/R/N: 6226.96/6363.73/1310.30), change:21.587, time: 2.7s, batch: 256, fails: 0
    Epoch 14/99 - loss: 13484.97 (P/R/N: 6531.90/5849.68/1103.39), change:21.718, time: 2.7s, batch: 256, fails: 0
    Epoch 15/99 - loss: 13118.05 (P/R/N: 6804.99/5365.05/948.02), change:21.642, time: 3.0s, batch: 256, fails: 0
    Epoch 16/99 - loss: 12835.15 (P/R/N: 7063.44/4922.84/848.87), change:22.255, time: 2.8s, batch: 256, fails: 0
    Epoch 17/99 - loss: 12572.30 (P/R/N: 7277.93/4522.02/772.35), change:22.481, time: 2.9s, batch: 256, fails: 0
    Epoch 18/99 - loss: 12368.03 (P/R/N: 7489.25/4180.40/698.38), change:22.555, time: 2.8s, batch: 256, fails: 0
    Epoch 19/99 - loss: 12199.71 (P/R/N: 7673.00/3882.37/644.34), change:22.851, time: 2.7s, batch: 256, fails: 0
    Epoch 20/99 - loss: 12074.16 (P/R/N: 7845.17/3624.46/604.54), change:23.014, time: 2.8s, batch: 256, fails: 0
    Epoch 21/99 - loss: 11947.27 (P/R/N: 7979.91/3397.16/570.20), change:23.321, time: 2.9s, batch: 256, fails: 0
    Epoch 22/99 - loss: 11872.15 (P/R/N: 8111.71/3204.18/556.26), change:23.614, time: 3.8s, batch: 256, fails: 0
    Epoch 23/99 - loss: 11798.18 (P/R/N: 8217.90/3041.72/538.56), change:23.898, time: 2.7s, batch: 256, fails: 0
    Epoch 24/99 - loss: 11743.02 (P/R/N: 8316.99/2906.84/519.20), change:23.866, time: 2.8s, batch: 256, fails: 0
    Epoch 25/99 - loss: 11696.12 (P/R/N: 8402.41/2793.20/500.51), change:24.075, time: 2.7s, batch: 256, fails: 0
    Epoch 26/99 - loss: 11670.62 (P/R/N: 8485.02/2697.09/488.51), change:24.451, time: 2.8s, batch: 256, fails: 0
    Epoch 27/99 - loss: 11624.16 (P/R/N: 8534.28/2610.95/478.93), change:24.992, time: 2.7s, batch: 256, fails: 0
    Epoch 28/99 - loss: 11611.57 (P/R/N: 8595.23/2545.65/470.69), change:24.684, time: 2.9s, batch: 256, fails: 0
    Epoch 29/99 - loss: 11586.78 (P/R/N: 8636.21/2480.75/469.82), change:25.069, time: 2.7s, batch: 256, fails: 0
    Epoch 30/99 - loss: 11581.09 (P/R/N: 8684.92/2429.15/467.02), change:25.485, time: 2.9s, batch: 256, fails: 0
    Epoch 31/99 - loss: 11557.43 (P/R/N: 8707.74/2386.09/463.60), change:25.459, time: 2.7s, batch: 256, fails: 0
    Epoch 32/99 - loss: 11527.55 (P/R/N: 8735.60/2342.13/449.81), change:25.485, time: 3.0s, batch: 256, fails: 0
    Epoch 33/99 - loss: 11538.56 (P/R/N: 8769.54/2315.00/454.02), change:26.050, time: 2.7s, batch: 256, fails: 1
    Epoch 34/99 - loss: 11528.43 (P/R/N: 8795.91/2289.81/442.71), change:26.326, time: 2.8s, batch: 256, fails: 2
    Stopping traing at epoch 34
Retrofit with '_get_retrofitted_embeds_v4_th' took 99.3s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.046
  Distance from negative 9745:   0.782

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1  12238 0.024  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  2  11625 0.025  CD / V/A / ULTIMATE ROCK (2015  MUZICA  CD International
  3   4416 0.026  CD / COLDPLAY / 4 CD CATALOGUE  MUZICA  CD International
  4  11718 0.027  CD / SIA / THIS IS ACTING (Del  MUZICA  CD International
  5   1408 0.027  CD / QUEEN / THE PLATINUM COLL  MUZICA  CD International
  6   7004 0.027  CD / PINK MARTINI / JE DIS OUI  MUZICA  CD International
  7  12707 0.029  CD / INXS / THE VERY BEST (201  MUZICA  CD International
  8   8366 0.029  CD / ANGELA GHEORGHIU / ETERNA  MUZICA  CD International
  9  12225 0.029  CD / FRANK SINATRA / NOTHING B  MUZICA  CD International
================================================================================================
================================================================================================
== Iteration 3: ================================================================================
================================================================================================
{'method': 'v4_th', 'batch_size': 256, 'dist': 'cos', 'fixed_weights': None}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v4_th
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v4_th()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing torch model...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, negative margin: 1, dist=cos, fixed_weights=None
    Epoch 01/99 - loss: 303.96 (P/R/N: 0.01/232.73/71.23), change:0.396, time: 3.1s, batch: 256, fails: 0
    Epoch 02/99 - loss: 302.82 (P/R/N: 0.11/232.51/70.20), change:0.389, time: 3.3s, batch: 256, fails: 0
    Epoch 03/99 - loss: 301.88 (P/R/N: 0.31/232.32/69.26), change:0.361, time: 3.1s, batch: 256, fails: 0
    Epoch 04/99 - loss: 301.11 (P/R/N: 0.57/232.14/68.40), change:0.352, time: 3.1s, batch: 256, fails: 0
    Epoch 05/99 - loss: 300.48 (P/R/N: 0.89/231.98/67.61), change:0.325, time: 3.1s, batch: 256, fails: 0
    Epoch 06/99 - loss: 299.96 (P/R/N: 1.24/231.84/66.89), change:0.304, time: 3.2s, batch: 256, fails: 0
    Epoch 07/99 - loss: 299.53 (P/R/N: 1.60/231.70/66.22), change:0.283, time: 3.1s, batch: 256, fails: 0
    Epoch 08/99 - loss: 299.18 (P/R/N: 1.96/231.58/65.64), change:0.283, time: 3.1s, batch: 256, fails: 0
    Epoch 09/99 - loss: 298.89 (P/R/N: 2.31/231.47/65.11), change:0.274, time: 3.1s, batch: 256, fails: 0
    Epoch 10/99 - loss: 298.66 (P/R/N: 2.68/231.37/64.60), change:0.252, time: 3.1s, batch: 256, fails: 0
    Epoch 11/99 - loss: 298.46 (P/R/N: 3.03/231.28/64.15), change:0.247, time: 3.1s, batch: 256, fails: 0
    Epoch 12/99 - loss: 298.30 (P/R/N: 3.38/231.20/63.72), change:0.174, time: 3.1s, batch: 256, fails: 0
    Epoch 13/99 - loss: 298.18 (P/R/N: 3.68/231.12/63.38), change:0.174, time: 3.3s, batch: 256, fails: 0
    Epoch 14/99 - loss: 298.08 (P/R/N: 3.99/231.05/63.03), change:0.160, time: 3.1s, batch: 256, fails: 0
    Epoch 15/99 - loss: 297.99 (P/R/N: 4.25/230.99/62.75), change:0.157, time: 3.1s, batch: 256, fails: 0
    Epoch 16/99 - loss: 297.92 (P/R/N: 4.50/230.93/62.49), change:0.129, time: 3.1s, batch: 256, fails: 0
    Epoch 17/99 - loss: 297.87 (P/R/N: 4.75/230.88/62.24), change:0.104, time: 3.5s, batch: 256, fails: 0
    Epoch 18/99 - loss: 297.82 (P/R/N: 4.96/230.83/62.02), change:0.085, time: 3.1s, batch: 256, fails: 0
    Epoch 19/99 - loss: 297.79 (P/R/N: 5.16/230.79/61.84), change:0.113, time: 3.1s, batch: 256, fails: 0
    Epoch 20/99 - loss: 297.76 (P/R/N: 5.34/230.75/61.66), change:0.084, time: 3.1s, batch: 256, fails: 0
    Epoch 21/99 - loss: 297.74 (P/R/N: 5.53/230.72/61.49), change:0.098, time: 3.1s, batch: 256, fails: 0
    Epoch 22/99 - loss: 297.71 (P/R/N: 5.67/230.68/61.36), change:0.097, time: 3.1s, batch: 256, fails: 0
    Epoch 23/99 - loss: 297.70 (P/R/N: 5.82/230.65/61.22), change:0.087, time: 3.0s, batch: 256, fails: 0
    Epoch 24/99 - loss: 297.69 (P/R/N: 5.97/230.63/61.09), change:0.082, time: 3.1s, batch: 256, fails: 0
    Epoch 25/99 - loss: 297.68 (P/R/N: 6.08/230.60/61.00), change:0.088, time: 3.2s, batch: 256, fails: 0
    Epoch 26/99 - loss: 297.67 (P/R/N: 6.19/230.58/60.89), change:0.065, time: 3.1s, batch: 256, fails: 0
    Epoch 27/99 - loss: 297.67 (P/R/N: 6.28/230.56/60.82), change:0.091, time: 3.1s, batch: 256, fails: 1
    Epoch 28/99 - loss: 297.66 (P/R/N: 6.36/230.54/60.75), change:0.094, time: 3.1s, batch: 256, fails: 0
    Epoch 29/99 - loss: 297.66 (P/R/N: 6.48/230.53/60.65), change:0.051, time: 3.3s, batch: 256, fails: 0
    Epoch 30/99 - loss: 297.65 (P/R/N: 6.54/230.51/60.60), change:0.074, time: 3.1s, batch: 256, fails: 0
    Epoch 31/99 - loss: 297.65 (P/R/N: 6.61/230.49/60.55), change:0.100, time: 3.1s, batch: 256, fails: 0
    Epoch 32/99 - loss: 297.65 (P/R/N: 6.67/230.48/60.50), change:0.079, time: 3.1s, batch: 256, fails: 0
    Epoch 33/99 - loss: 297.65 (P/R/N: 6.74/230.47/60.43), change:0.095, time: 3.1s, batch: 256, fails: 0
    Epoch 34/99 - loss: 297.64 (P/R/N: 6.80/230.46/60.38), change:0.119, time: 3.1s, batch: 256, fails: 0
    Epoch 35/99 - loss: 297.64 (P/R/N: 6.82/230.45/60.37), change:0.157, time: 3.1s, batch: 256, fails: 0
    Epoch 36/99 - loss: 297.65 (P/R/N: 6.90/230.44/60.30), change:0.049, time: 3.3s, batch: 256, fails: 1
    Epoch 37/99 - loss: 297.64 (P/R/N: 6.94/230.43/60.27), change:0.053, time: 3.3s, batch: 256, fails: 2
    Stopping traing at epoch 37
Retrofit with '_get_retrofitted_embeds_v4_th' took 119.0s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.639
  Distance from negative 9745:   0.701

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME               H1                    H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (           MUZICA      CD International
  1   4416 0.625  CD / COLDPLAY / 4 CD CATALOGUE           MUZICA      CD International
  2  11418 0.639  CD / DAVID BOWIE / BEST OF BOW           MUZICA      CD International
  3   4865 0.660  CD / COLDPLAY / A HEAD FULL OF           MUZICA      CD International
  4   8403 0.685  1001 DE CARTI DE CITIT INTR-O         CARTE ROM  POEZIE / TEATRU / ST
  5   7933 0.692     CUVINTE INCRUCISATE/ IQ FUN        CARTE ROM    CARTI PENTRU COPII
  6   4263 0.693  COUNTRY MERRY CHRISTMAS / 3 M      PAPETARIE AA              Giftware
  7   9745 0.701  MASINI DIE-CAST 7.5cm III ASST          JUCARII               JUCARII
  8   4400 0.702  CARTEA SARUTURILOR / IV CEL NA        CARTE ROM  POEZIE / TEATRU / ST
  9   8392 0.703                13.2X2.5CM PLATE  ACCESORII GASTR  Accesorii servit mas
================================================================================================
================================================================================================
== Iteration 4: ================================================================================
================================================================================================
{'method': 'v4_th', 'batch_size': 256, 'dist': 'cos', 'fixed_weights': 1}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v4_th
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v4_th()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing torch model...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, negative margin: 1, dist=cos, fixed_weights=1
    Epoch 01/99 - loss: 90737.49 (P/R/N: 1051.76/89435.79/249.95), change:399.226, time: 3.3s, batch: 256, fails: 0
    Epoch 02/99 - loss: 23674.49 (P/R/N: 8514.13/15001.62/158.74), change:42.338, time: 3.1s, batch: 256, fails: 0
    Epoch 03/99 - loss: 13096.62 (P/R/N: 8188.79/4794.22/113.61), change:37.939, time: 3.1s, batch: 256, fails: 0
    Epoch 04/99 - loss: 10609.73 (P/R/N: 7773.18/2747.19/89.37), change:34.147, time: 3.1s, batch: 256, fails: 0
    Epoch 05/99 - loss: 9213.41 (P/R/N: 7265.67/1873.18/74.57), change:30.636, time: 3.2s, batch: 256, fails: 0
    Epoch 06/99 - loss: 8242.77 (P/R/N: 6781.83/1396.39/64.55), change:27.498, time: 3.1s, batch: 256, fails: 0
    Epoch 07/99 - loss: 7521.48 (P/R/N: 6354.01/1110.25/57.22), change:24.682, time: 3.1s, batch: 256, fails: 0
    Epoch 08/99 - loss: 6963.78 (P/R/N: 5985.59/926.55/51.65), change:22.168, time: 3.1s, batch: 256, fails: 0
    Epoch 09/99 - loss: 6530.59 (P/R/N: 5674.31/809.29/46.99), change:20.584, time: 3.3s, batch: 256, fails: 0
    Epoch 10/99 - loss: 6183.28 (P/R/N: 5415.80/724.26/43.23), change:18.377, time: 3.0s, batch: 256, fails: 0
    Epoch 11/99 - loss: 5897.32 (P/R/N: 5201.39/655.77/40.16), change:16.340, time: 3.1s, batch: 256, fails: 0
    Epoch 12/99 - loss: 5679.21 (P/R/N: 5024.98/616.97/37.26), change:15.406, time: 3.1s, batch: 256, fails: 0
    Epoch 13/99 - loss: 5500.74 (P/R/N: 4879.30/586.57/34.88), change:13.253, time: 3.2s, batch: 256, fails: 0
    Epoch 14/99 - loss: 5353.67 (P/R/N: 4763.57/557.41/32.68), change:13.137, time: 3.4s, batch: 256, fails: 0
    Epoch 15/99 - loss: 5244.03 (P/R/N: 4667.65/545.58/30.80), change:11.885, time: 3.1s, batch: 256, fails: 0
    Epoch 16/99 - loss: 5162.56 (P/R/N: 4591.85/541.72/29.00), change:23.034, time: 3.1s, batch: 256, fails: 0
    Epoch 17/99 - loss: 5138.20 (P/R/N: 4539.90/570.90/27.40), change:12.174, time: 3.0s, batch: 256, fails: 0
    Epoch 18/99 - loss: 5050.48 (P/R/N: 4492.91/531.61/25.96), change:10.298, time: 3.1s, batch: 256, fails: 0
    Epoch 19/99 - loss: 5085.99 (P/R/N: 4450.96/610.41/24.61), change:18.412, time: 3.1s, batch: 256, fails: 1
    Epoch 20/99 - loss: 5304.74 (P/R/N: 4441.29/839.97/23.47), change:34.207, time: 3.3s, batch: 256, fails: 2
    Stopping traing at epoch 20
Retrofit with '_get_retrofitted_embeds_v4_th' took 65.2s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.015
  Distance from negative 9745:   0.748

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1   4416 0.010  CD / COLDPLAY / 4 CD CATALOGUE  MUZICA  CD International
  2   6275 0.011  CD / LANA DEL REY / LUST FOR L  MUZICA  CD International
  3  12379 0.011  CD / CARRERAS / DOMINGO / PAVA  MUZICA  CD International
  4  11931 0.011  CD / PANIC! AT THE DISCO / DEA  MUZICA  CD International
  5   9333 0.011  CD / GREEN DAY / AMERICAN IDIO  MUZICA  CD International
  6  12238 0.011  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  7  12707 0.011  CD / INXS / THE VERY BEST (201  MUZICA  CD International
  8   9040 0.011  CD / LEONARD COHEN / YOU WANT   MUZICA  CD International
  9  11343 0.011  CD / BOB DYLAN / THE ESSENTIAL  MUZICA  CD International
================================================================================================
================================================================================================
== Iteration 5: ================================================================================
================================================================================================
{'method': 'v5_tf', 'batch_size': 256, 'dist': 'l1'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v5_tf
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v5_tf()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing model...
  Preparing dataset...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, dist=l1, neg_margin=128
    Epoch 01/99 - loss: 31592.94, change:15.551, time: 12.8s, batch: 256, fails: 0
    Epoch 02/99 - loss: 31274.88, change:9.382, time: 12.0s, batch: 256, fails: 0
    Epoch 03/99 - loss: 30637.13, change:6.591, time: 11.7s, batch: 256, fails: 0
    Epoch 04/99 - loss: 30099.41, change:6.293, time: 11.7s, batch: 256, fails: 0
    Epoch 05/99 - loss: 29660.79, change:6.117, time: 11.6s, batch: 256, fails: 0
    Epoch 06/99 - loss: 29254.65, change:5.880, time: 11.7s, batch: 256, fails: 0
    Epoch 07/99 - loss: 28917.52, change:5.787, time: 12.0s, batch: 256, fails: 0
    Epoch 08/99 - loss: 28593.90, change:5.502, time: 11.8s, batch: 256, fails: 0
    Epoch 09/99 - loss: 28330.41, change:5.474, time: 11.6s, batch: 256, fails: 0
    Epoch 10/99 - loss: 28074.16, change:5.318, time: 11.6s, batch: 256, fails: 0
    Epoch 11/99 - loss: 27855.92, change:5.289, time: 11.6s, batch: 256, fails: 0
    Epoch 12/99 - loss: 27646.63, change:5.148, time: 11.9s, batch: 256, fails: 0
    Epoch 13/99 - loss: 27452.89, change:5.180, time: 11.6s, batch: 256, fails: 0
    Epoch 14/99 - loss: 27283.16, change:5.097, time: 11.6s, batch: 256, fails: 0
    Epoch 15/99 - loss: 27122.84, change:5.010, time: 11.7s, batch: 256, fails: 0
    Epoch 16/99 - loss: 26974.04, change:4.961, time: 11.6s, batch: 256, fails: 0
    Epoch 17/99 - loss: 26838.82, change:4.953, time: 11.6s, batch: 256, fails: 0
    Epoch 18/99 - loss: 26714.37, change:4.903, time: 12.0s, batch: 256, fails: 0
    Epoch 19/99 - loss: 26592.85, change:4.854, time: 11.6s, batch: 256, fails: 0
    Epoch 20/99 - loss: 26484.37, change:4.840, time: 11.6s, batch: 256, fails: 0
    Epoch 21/99 - loss: 26373.35, change:4.797, time: 11.4s, batch: 256, fails: 0
    Epoch 22/99 - loss: 26274.38, change:4.761, time: 11.6s, batch: 256, fails: 0
    Epoch 23/99 - loss: 26177.88, change:4.822, time: 12.2s, batch: 256, fails: 0
    Epoch 24/99 - loss: 26082.49, change:4.736, time: 11.6s, batch: 256, fails: 0
    Epoch 25/99 - loss: 25991.65, change:4.805, time: 11.6s, batch: 256, fails: 0
    Epoch 26/99 - loss: 25908.52, change:4.744, time: 11.6s, batch: 256, fails: 0
    Epoch 27/99 - loss: 25825.88, change:4.736, time: 11.6s, batch: 256, fails: 0
    Epoch 28/99 - loss: 25746.68, change:4.776, time: 12.0s, batch: 256, fails: 0
    Epoch 29/99 - loss: 25667.62, change:4.730, time: 11.6s, batch: 256, fails: 0
    Epoch 30/99 - loss: 25594.91, change:4.689, time: 11.6s, batch: 256, fails: 0
    Epoch 31/99 - loss: 25523.90, change:4.730, time: 11.6s, batch: 256, fails: 0
    Epoch 32/99 - loss: 25455.21, change:4.663, time: 11.9s, batch: 256, fails: 0
    Epoch 33/99 - loss: 25387.38, change:4.644, time: 12.0s, batch: 256, fails: 0
    Epoch 34/99 - loss: 25327.01, change:4.681, time: 11.6s, batch: 256, fails: 0
    Epoch 35/99 - loss: 25262.17, change:4.693, time: 11.6s, batch: 256, fails: 0
    Epoch 36/99 - loss: 25205.29, change:4.688, time: 11.6s, batch: 256, fails: 0
    Epoch 37/99 - loss: 25142.26, change:4.648, time: 11.6s, batch: 256, fails: 0
    Epoch 38/99 - loss: 25089.78, change:4.677, time: 12.0s, batch: 256, fails: 0
    Epoch 39/99 - loss: 25032.20, change:4.683, time: 11.7s, batch: 256, fails: 0
    Epoch 40/99 - loss: 24978.98, change:4.674, time: 11.6s, batch: 256, fails: 0
    Epoch 41/99 - loss: 24924.26, change:4.641, time: 11.6s, batch: 256, fails: 0
    Epoch 42/99 - loss: 24877.78, change:4.648, time: 11.6s, batch: 256, fails: 0
    Epoch 43/99 - loss: 24823.75, change:4.632, time: 12.0s, batch: 256, fails: 0
    Epoch 44/99 - loss: 24778.80, change:4.651, time: 11.6s, batch: 256, fails: 0
    Epoch 45/99 - loss: 24730.15, change:4.676, time: 11.6s, batch: 256, fails: 0
    Epoch 46/99 - loss: 24682.59, change:4.652, time: 11.6s, batch: 256, fails: 0
    Epoch 47/99 - loss: 24637.54, change:4.685, time: 11.6s, batch: 256, fails: 0
    Epoch 48/99 - loss: 24595.91, change:4.714, time: 12.2s, batch: 256, fails: 0
    Epoch 49/99 - loss: 24549.21, change:4.661, time: 11.4s, batch: 256, fails: 0
    Epoch 50/99 - loss: 24511.93, change:4.678, time: 11.6s, batch: 256, fails: 0
    Epoch 51/99 - loss: 24467.74, change:4.657, time: 11.6s, batch: 256, fails: 0
    Epoch 52/99 - loss: 24429.87, change:4.669, time: 11.6s, batch: 256, fails: 0
    Epoch 53/99 - loss: 24389.90, change:4.706, time: 12.0s, batch: 256, fails: 0
    Epoch 54/99 - loss: 24354.39, change:4.604, time: 11.6s, batch: 256, fails: 0
    Epoch 55/99 - loss: 24312.09, change:4.677, time: 11.6s, batch: 256, fails: 0
    Epoch 56/99 - loss: 24280.41, change:4.671, time: 11.5s, batch: 256, fails: 0
    Epoch 57/99 - loss: 24243.17, change:4.702, time: 11.6s, batch: 256, fails: 0
    Epoch 58/99 - loss: 24208.46, change:4.659, time: 12.0s, batch: 256, fails: 0
    Epoch 59/99 - loss: 24173.73, change:4.683, time: 12.0s, batch: 256, fails: 0
    Epoch 60/99 - loss: 24140.66, change:4.680, time: 11.6s, batch: 256, fails: 0
    Epoch 61/99 - loss: 24107.56, change:4.696, time: 11.5s, batch: 256, fails: 0
    Epoch 62/99 - loss: 24076.45, change:4.613, time: 11.6s, batch: 256, fails: 0
    Epoch 63/99 - loss: 24043.24, change:4.679, time: 11.6s, batch: 256, fails: 0
    Epoch 64/99 - loss: 24014.25, change:4.654, time: 12.1s, batch: 256, fails: 0
    Epoch 65/99 - loss: 23981.54, change:4.687, time: 11.6s, batch: 256, fails: 0
    Epoch 66/99 - loss: 23955.25, change:4.674, time: 11.6s, batch: 256, fails: 0
    Epoch 67/99 - loss: 23923.16, change:4.663, time: 11.6s, batch: 256, fails: 0
    Epoch 68/99 - loss: 23895.25, change:4.678, time: 11.6s, batch: 256, fails: 0
    Epoch 69/99 - loss: 23867.25, change:4.697, time: 12.1s, batch: 256, fails: 0
    Epoch 70/99 - loss: 23840.74, change:4.651, time: 11.7s, batch: 256, fails: 0
    Epoch 71/99 - loss: 23811.37, change:4.695, time: 11.6s, batch: 256, fails: 0
    Epoch 72/99 - loss: 23788.45, change:4.685, time: 11.6s, batch: 256, fails: 0
    Epoch 73/99 - loss: 23759.78, change:4.673, time: 11.6s, batch: 256, fails: 0
    Epoch 74/99 - loss: 23736.16, change:4.708, time: 12.0s, batch: 256, fails: 0
    Epoch 75/99 - loss: 23708.90, change:4.678, time: 11.6s, batch: 256, fails: 0
    Epoch 76/99 - loss: 23688.61, change:4.717, time: 11.5s, batch: 256, fails: 0
    Epoch 77/99 - loss: 23659.69, change:4.755, time: 11.4s, batch: 256, fails: 0
    Epoch 78/99 - loss: 23640.93, change:4.751, time: 11.5s, batch: 256, fails: 0
    Epoch 79/99 - loss: 23612.05, change:4.726, time: 11.5s, batch: 256, fails: 0
    Epoch 80/99 - loss: 23592.73, change:4.736, time: 11.5s, batch: 256, fails: 0
    Epoch 81/99 - loss: 23568.57, change:4.788, time: 11.5s, batch: 256, fails: 0
    Epoch 82/99 - loss: 23545.94, change:4.763, time: 11.5s, batch: 256, fails: 0
    Epoch 83/99 - loss: 23526.52, change:4.742, time: 11.6s, batch: 256, fails: 0
    Epoch 84/99 - loss: 23503.53, change:4.770, time: 11.5s, batch: 256, fails: 0
    Epoch 85/99 - loss: 23480.86, change:4.770, time: 11.5s, batch: 256, fails: 0
    Epoch 86/99 - loss: 23462.99, change:4.727, time: 11.5s, batch: 256, fails: 0
    Epoch 87/99 - loss: 23440.72, change:4.853, time: 11.5s, batch: 256, fails: 0
    Epoch 88/99 - loss: 23418.44, change:4.801, time: 11.5s, batch: 256, fails: 0
    Epoch 89/99 - loss: 23396.05, change:4.847, time: 11.6s, batch: 256, fails: 0
    Epoch 90/99 - loss: 23381.30, change:4.815, time: 11.6s, batch: 256, fails: 0
    Epoch 91/99 - loss: 23356.81, change:4.808, time: 11.5s, batch: 256, fails: 0
    Epoch 92/99 - loss: 23341.78, change:4.815, time: 11.5s, batch: 256, fails: 0
    Epoch 93/99 - loss: 23318.61, change:4.869, time: 11.4s, batch: 256, fails: 0
    Epoch 94/99 - loss: 23302.18, change:4.905, time: 11.4s, batch: 256, fails: 0
    Epoch 95/99 - loss: 23282.30, change:4.868, time: 11.5s, batch: 256, fails: 0
    Epoch 96/99 - loss: 23268.17, change:4.865, time: 11.5s, batch: 256, fails: 0
    Epoch 97/99 - loss: 23246.30, change:4.889, time: 11.6s, batch: 256, fails: 0
    Epoch 98/99 - loss: 23230.42, change:4.868, time: 11.5s, batch: 256, fails: 0
    Epoch 99/99 - loss: 23210.05, change:4.907, time: 11.5s, batch: 256, fails: 0
Retrofit with '_get_retrofitted_embeds_v5_tf' took 1165.9s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.248
  Distance from negative 9745:   0.741

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1  12238 0.172  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  2   6275 0.175  CD / LANA DEL REY / LUST FOR L  MUZICA  CD International
  3   9991 0.177  CD / LED ZEPPELIN / REMASTERS   MUZICA  CD International
  4   4865 0.187  CD / COLDPLAY / A HEAD FULL OF  MUZICA  CD International
  5   1175 0.187  CD / QUEEN / GREATEST HITS (20  MUZICA  CD International
  6  11406 0.191  CD / FLORENCE + THE MACHINE /   MUZICA  CD International
  7   1408 0.193  CD / QUEEN / THE PLATINUM COLL  MUZICA  CD International
  8  12862 0.196  CD / DREAM THEATER / THE TRIPL  MUZICA  CD International
  9   1703 0.196  CD / QUEEN / GREATEST HITS II   MUZICA  CD International
================================================================================================
================================================================================================
== Iteration 6: ================================================================================
================================================================================================
{'method': 'v5_tf', 'batch_size': 256, 'dist': 'l2'}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v5_tf
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v5_tf()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing model...
  Preparing dataset...
  Training model for 99 epochs, batch=256, lr=5.0e-02, tol=1.0e-03, dist=l2, neg_margin=128
    Epoch 01/99 - loss: 30678.82, change:16.886, time: 12.3s, batch: 256, fails: 0
    Epoch 02/99 - loss: 28146.93, change:12.147, time: 11.7s, batch: 256, fails: 0
    Epoch 03/99 - loss: 25875.77, change:14.107, time: 11.7s, batch: 256, fails: 0
    Epoch 04/99 - loss: 23630.41, change:15.732, time: 11.7s, batch: 256, fails: 0
    Epoch 05/99 - loss: 21569.78, change:16.940, time: 11.6s, batch: 256, fails: 0
    Epoch 06/99 - loss: 19836.18, change:18.004, time: 11.7s, batch: 256, fails: 0
    Epoch 07/99 - loss: 18436.80, change:18.701, time: 11.7s, batch: 256, fails: 0
    Epoch 08/99 - loss: 17340.53, change:19.243, time: 11.7s, batch: 256, fails: 0
    Epoch 09/99 - loss: 16409.34, change:19.323, time: 11.8s, batch: 256, fails: 0
    Epoch 10/99 - loss: 15639.24, change:19.636, time: 12.0s, batch: 256, fails: 0
    Epoch 11/99 - loss: 14995.63, change:19.965, time: 11.7s, batch: 256, fails: 0
    Epoch 12/99 - loss: 14413.39, change:19.951, time: 11.7s, batch: 256, fails: 0
    Epoch 13/99 - loss: 13934.17, change:20.279, time: 11.7s, batch: 256, fails: 0
    Epoch 14/99 - loss: 13520.18, change:20.134, time: 11.7s, batch: 256, fails: 0
    Epoch 15/99 - loss: 13144.38, change:20.350, time: 11.7s, batch: 256, fails: 0
    Epoch 16/99 - loss: 12866.28, change:20.562, time: 11.7s, batch: 256, fails: 0
    Epoch 17/99 - loss: 12602.65, change:20.720, time: 11.7s, batch: 256, fails: 0
    Epoch 18/99 - loss: 12406.43, change:21.017, time: 11.8s, batch: 256, fails: 0
    Epoch 19/99 - loss: 12231.90, change:21.096, time: 11.8s, batch: 256, fails: 0
    Epoch 20/99 - loss: 12108.40, change:21.290, time: 11.7s, batch: 256, fails: 0
    Epoch 21/99 - loss: 11987.12, change:21.417, time: 11.7s, batch: 256, fails: 0
    Epoch 22/99 - loss: 11910.88, change:21.803, time: 11.7s, batch: 256, fails: 0
    Epoch 23/99 - loss: 11848.34, change:22.077, time: 11.8s, batch: 256, fails: 0
    Epoch 24/99 - loss: 11777.63, change:22.265, time: 11.7s, batch: 256, fails: 0
    Epoch 25/99 - loss: 11743.90, change:22.481, time: 11.8s, batch: 256, fails: 0
    Epoch 26/99 - loss: 11707.45, change:22.881, time: 11.7s, batch: 256, fails: 0
    Epoch 27/99 - loss: 11675.95, change:22.888, time: 11.8s, batch: 256, fails: 0
    Epoch 28/99 - loss: 11660.07, change:23.200, time: 11.7s, batch: 256, fails: 0
    Epoch 29/99 - loss: 11633.82, change:23.621, time: 12.1s, batch: 256, fails: 0
    Epoch 30/99 - loss: 11623.82, change:23.610, time: 11.7s, batch: 256, fails: 0
    Epoch 31/99 - loss: 11605.63, change:24.061, time: 11.7s, batch: 256, fails: 0
    Epoch 32/99 - loss: 11594.63, change:23.874, time: 12.8s, batch: 256, fails: 0
    Epoch 33/99 - loss: 11565.81, change:24.114, time: 11.7s, batch: 256, fails: 0
    Epoch 34/99 - loss: 11578.12, change:24.377, time: 11.7s, batch: 256, fails: 1
    Epoch 35/99 - loss: 11557.81, change:24.612, time: 11.7s, batch: 256, fails: 0
    Epoch 36/99 - loss: 11569.62, change:24.925, time: 11.7s, batch: 256, fails: 1
    Epoch 37/99 - loss: 11550.99, change:24.859, time: 11.7s, batch: 256, fails: 0
    Epoch 38/99 - loss: 11541.85, change:24.832, time: 11.7s, batch: 256, fails: 0
    Epoch 39/99 - loss: 11539.13, change:24.833, time: 11.8s, batch: 256, fails: 0
    Epoch 40/99 - loss: 11528.94, change:25.211, time: 11.6s, batch: 256, fails: 0
    Epoch 41/99 - loss: 11521.32, change:25.328, time: 11.7s, batch: 256, fails: 0
    Epoch 42/99 - loss: 11518.22, change:25.639, time: 11.5s, batch: 256, fails: 0
    Epoch 43/99 - loss: 11536.46, change:25.929, time: 11.5s, batch: 256, fails: 1
    Epoch 44/99 - loss: 11507.38, change:25.515, time: 11.5s, batch: 256, fails: 0
    Epoch 45/99 - loss: 11509.75, change:25.414, time: 11.5s, batch: 256, fails: 1
    Epoch 46/99 - loss: 11512.40, change:25.744, time: 11.5s, batch: 256, fails: 2
    Stopping traing at epoch 46
Retrofit with '_get_retrofitted_embeds_v5_tf' took 545.6s
Total 12997 embeddings modified
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy
  Distance from positive 11418:  0.644
  Distance from negative 9745:   0.665
Analysis of 12071: 'CD / DAVID BOWIE / BLACKSTAR ('  using model exp_v4es_033.npy_RETRO
  Distance from positive 11418:  0.040
  Distance from negative 9745:   0.752

  Table: Non-filtered neighbors of 12071 using retrofitted exp_v4es_033.npy model
        ID  DIST                            NAME      H1                H2
  0  12071 0.000  CD / DAVID BOWIE / BLACKSTAR (  MUZICA  CD International
  1   4416 0.020  CD / COLDPLAY / 4 CD CATALOGUE  MUZICA  CD International
  2  12238 0.021  CD / RED HOT CHILI PEPPERS / T  MUZICA  CD International
  3   7004 0.021  CD / PINK MARTINI / JE DIS OUI  MUZICA  CD International
  4  11625 0.021  CD / V/A / ULTIMATE ROCK (2015  MUZICA  CD International
  5  12225 0.022  CD / FRANK SINATRA / NOTHING B  MUZICA  CD International
  6   1408 0.023  CD / QUEEN / THE PLATINUM COLL  MUZICA  CD International
  7   8366 0.024  CD / ANGELA GHEORGHIU / ETERNA  MUZICA  CD International
  8   6275 0.024  CD / LANA DEL REY / LUST FOR L  MUZICA  CD International
  9   4772 0.025  CD / MILES DAVIS / KIND OF BLU  MUZICA  CD International
================================================================================================
================================================================================================
== Iteration 7: ================================================================================
================================================================================================
{'method': 'v5_tf', 'batch_size': 256, 'dist': 'cos', 'fixed_weights': None}
================================================================================================

Performing retrofitting on (13000, 128) embedding matrix...
  Product(s):  None
  Full edges:  True
  Method:      _get_retrofitted_embeds_v5_tf
  Pos edges: 13000
  Neg edges: 13000
Starting `_get_retrofitted_embeds_v5_tf()` retrofit function
  Preparing retrofit data based on dict(13000)...
    Positive edges: 13000
    Negative edges: 13000
  Preparing model...
